<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta name=viewport content="width=device-width, initial-scale=1">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>BHIT: Bayesian High-order Interaction Toolkit</title>
<link rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="style.css" type="text/css" />
<script type="text/javascript">	
	
	function chkEmail(email)
	{
		if ( (email.indexOf("@") == -1) || (email.indexOf(".") == -1) )
			return false;
	
		if (email.indexOf("\\") > -1)
			return false;
	
		if (email.indexOf("/") > -1)
			return false;
	
		if (email.indexOf("'") > -1)
			return false;
	
		if (email.indexOf("!") > -1)
			return false;
			
		if ( (email.indexOf(",") > -1) || (email.indexOf(";") > -1) )
			return false;
		
		return true;
		
	} 	
        
	function chkEmailedu(email)
        {
                var pos = email.indexOf("@");
                if((email.indexOf(".edu") > pos) && (email.indexOf(".edu") > -1))
                        return true;
                if((email.indexOf(".org") > pos) && (email.indexOf(".org") > -1))
                        return true;
		if((email.indexOf(".ac") > pos) && (email.indexOf(".ac") > -1))
                        return true;
		return false;
        }

	function chkName(name){
    		var Pattern=/^[A-Za-z .'-]+$/;
    		if(!Pattern.test(name)){
			return false;
    		}
		return true;
	}		

	function chkEmailByPattern(email){
		var emailPattern=/^[_A-Za-z0-9-]+(\.[_A-Za-z0-9-]+)*@([A-Za-z0-9-])+(\.[A-Za-z0-9-]+)*((\.[A-Za-z0-9]{2,})|(\.[A-Za-z0-9]{2,}\.[A-Za-z0-9]{2,}))$/;
			
		if(!emailPattern.test(email)){
			return false;
		}
	 
		return true;
		 
	}
	
	function runFormCheck() 
	{
		if(document.getElementById("myCheck").checked == false)
		{
			alert("Please accept the terms.");
			return false;
		}
		firstname = document.contactform.first_name.value;
		lastname  = document.contactform.last_name.value;	
		emailaddr = document.contactform.email.value;
		if(firstname == "")
		{
			alert("First Name is required.");
			return false;
		}		
		if(!chkName(firstname)){
			alert("Invalid First Name.");
			return false;
		}
		if(lastname == "")
                {
                        alert("Last Name is required.");
                        return false;
                }
                if(!chkName(lastname)){
                        alert("Invalid Last Name.");
                        return false;
                }
		emailaddr=emailaddr.replace(/(^[\\s]*)|([\\s]*$)/g, "");
		if(emailaddr == "") 
		{
			alert("Email address is required.");
			return false;
		}	
		
		if(!chkEmail(emailaddr))
		{
			alert("Invalid Email address.");
			return false;
		}
		
		if(!chkEmailedu(emailaddr))
                {
                        alert("Please use Email address with postfix edu/org/ac\nIf you are not Academic user,please connect with Prof. Dong Xu (xudong@missouri.edu)");
                        return false;
                }
		document.contactform.submit();
	}
	
	
	

</script>
</head>

<body>
<div id="wrapper">

		<div id="header">
		
			<h1><a href="index.html"><b>B</b>ayesian <b>H</b>igh-order <b>I</b>nteraction <b>T</b>oolkit (BHIT)</a></h1>
		
		</div>

		<div id="content">
		<h2>Introduction</h2>
<p>
BHIT, a novel Bayesian partition computational method for detecting SNP interactions (epistasis). The proposed approach builds a Bayesian model on both continuous data and discrete data to partition multiple-phenotype data. Comparing with other methods on both simulation data and real data, the key strengths of BHIT are as follows: (i) With the advanced Bayesian model equipped with MCMC search, BHIT can efficiently explore high-order interactions. (ii) BHIT has a flexible Bayesian model on continuous and discrete data, so that both continuous and discrete phenotypes could be handled simultaneously, and the interaction within or between phenotypes and genetic data can also be detected.
</p>

<h2>Request Download BHIT</h2>

<form name="contactform" method="post" action="send_form_email.php">
 
<table width="450px">
 
<tr>
I agree to use BHIT for academic research or teaching purposes only. I will not use it for any commercial purpose, or redistribute this program to other users. I agree that any public report or publication of results obtained using BHIT will acknowledge its use by an appropriate citation of this website.
</tr>

<tr>
<td>
<input type="checkbox" id="myCheck"> I agree the term
</td>
</tr>

<tr>
 <td valign="top">
  <label for="first_name">First Name *</label>
 </td>
 <td valign="top">
  <input  type="text" name="first_name" maxlength="50" size="30">
 </td>
</tr>
 
<tr>
 <td valign="top"">
  <label for="last_name">Last Name *</label>
 </td>
 <td valign="top">
  <input  type="text" name="last_name" maxlength="50" size="30">
 </td>
</tr>

<tr>
 <td valign="top">
  <label for="email">Email Address *</label>
 </td>
 <td valign="top">
  <input  type="text" name="email" maxlength="80" size="30">
 </td>
</tr>

<tr>
 <td colspan="2" style="text-align:center">
  <input type="button"
  name="run" id="run" value="Submit"
  onClick="runFormCheck(); return false;" /> 
 </td>
</tr>
</table>
</form>


<p>
<h2>Prerequisite</h2>
<ul>
<li>x86_64bit Linux System</li>
<li>G++ version 4.4.7 and up</li>
<li>GSL Library (<a href="http://www.gnu.org/software/gsl/">http://www.gnu.org/software/gsl/</a>)</li>
<li>GSLWrap Library (<a href="http://gslwrap.sourceforge.net/">http://gslwrap.sourceforge.net</a>)</li>
</ul>
</p>
<h2>Usage:</h2>
<p>
 BHIT inputfilename outputfilename iterNum burninNum observNum SNPNum PhenoNum MAF newRuningTag
<ul>
<li><b>inputfilename:</b> The name of inputfile</li> 
<li><b>outputfilename:</b> The name of outputfile</li>
<li><b>iterNum:</b> Number of Iteration of MCMC</li>
<li><b>burinNum:</b> Number of burn-in of MCMC</li>
<li><b>observNum:</b> Number of observations, e.g. number of population</li>
<li><b>SNPNum:</b> Number of SNPs</li>
<li><b>PhenoNum:</b> Number of phenotype types</li>
<li><b>MAF:</b>Minor Allel Frequency, should less than 1</li>
<li><b>newRunningTag:</b> 1 for new status, 0 for continuing from old status</li>
</ul>
</p>

<h2>Input Example:</h2>
<p>
Example in input.txt<br>
1 2 3 2 1 0.55 0.48<br>
2 1 1 3 2 0.86 0.37<br>
2 2 1 1 3 0.10 0.76<br>
...<br>
Each line represents one observation. One observation includes 5 SNP and followed by 2 quantitative phenotype. Each SNP is represented as a digit. 1 represents homozygous major allel; 3 represents homozygous minor allel; 2 represents heterozytous.<br>
<b>Note:</b> Users could easily use <a href="convert.pl">convert.pl</a> to convert PLINK raw files to inputfiles (To convert your <a href="http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml#ped">ped</a> or <a href="http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml#bed">bed</a> file to a raw file use the plink <a href="http://pngu.mgh.harvard.edu/~purcell/plink/dataman.shtml#recode">--recodeA</a> option).
</p>

<h2>Output:</h2>
Contains 3 output files.
<ul>
<li><b>outputfile:</b> results of BHIT</li>
<li><b>tracefile:</b> recoding marginal likelihood status</li>
<li><b>tagfile:</b> recording MCMC status</li>
</ul>
The following tables are the contents of the output files for each of the above data sets; the output shows the proportion of times each data set spent in each partition group after the burn-in period:<br> 
<pre>
	0	1	
D1	0	1	
D2	0	1	
D3	0	1	
D4	1	0	
D5	1	0	
C1	0	1	
C2	0	1
</pre>
The 0 column represents independent data sets, and other columns show D1, D2, D3, C1 and C2 are in one partition by identifier 1.
<p>

</p>

<h2>Flowchart of BHIT pipeline</h2>
<p>
The BHIT pipeline on general species is shown as Figure below. In preprocessing stage, missing data imputation methods (<a target="_blank" href="http://compgen.unc.edu/wp/?page_id=57">Nputet</a>, <a target="_blank" href="http://stephenslab.uchicago.edu/software.html#fastphase">fastPHASE</a>, etc.) should be applied to fill the blank space if missing value exists in the genotype data. Then we filter SNP with MAF less than 0.05. All the genotype data should be convert to appropriate data format by PLINK --recodeA. If the input phenotype has continuous trait, whether it follows the normal distribution should be checked by <a target="_blank" href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test">Kolmogorov-Smirnov test</a>. After that, both genotype and phenotype data should be combine together and converted to BHIT file format by <a target="_blank" href="convert.pl">script</a> provided by BHIT website. In order to dealing with genome-wide SNPs, we provide three strategies to use BHIT in the pipeline. Strategy A has a two stages, feature selection methods (<a target="_blank" href="http://statweb.stanford.edu/~tibs/lasso.html">LASSO</a>, etc) could be used first to filter all SNPs and run BHIT only on the filtered set of SNPs. Strategy B splits all SNPs into different chromosomes and run BHIT on individual chromosomes. Strategy C is mainly focused on SNPs located on protein-coding regions and/or located several known regions users defined. In the end, check and validate all the results. 
<img src="FlowChart.png" alt="FlowChart" WIDTH=800 HEIGHT=450>
</p>

<h2>Contact:</h2>
<p>If you have questions and suggestions, please contact with Juexin Wang (<a href="mailto:wangjue@missouri.com">wangjue@missouri.edu</a>) </p>

<h2>Reference:</h2>
<p>Juexin Wang, Trupti Joshi, Babu Valliyodan, Haiying Shi, Yanchun Liang, Henry T. Nguyen, Jing Zhang, and Dong Xu. "A Bayesian model for detection of high-order interactions among genetic variants in genome-wide association studies." BMC genomics 16, no. 1 (2015): 1011 <a target="_blank" href="http://www.ncbi.nlm.nih.gov/pubmed/26607428">PubMed</a>  <a target="_blank" href="http://www.biomedcentral.com/1471-2164/16/1011">PaperLink</a></p>
</div>
<div id="footer"><br />
		&copy; 2015 digbio.missouri.edu | <i>Last updated at 10/8/2015</i> | Designed by <a href="http://digbio.missouri.edu/BHIT/">Juexin Wang</a>
		</div>
</div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10008772; 
var sc_invisible=0; 
var sc_security="9ebd86b9"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="website
statistics" href="http://statcounter.com/free-web-stats/"
target="_blank"><img class="statcounter"
src="http://c.statcounter.com/10008772/0/9ebd86b9/0/"
alt="website statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</body>

</html>

