<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>



  
  <meta content="text/html; charset=windows-1252" http-equiv="content-type"><title>BIRD - Bayesian Inference of Regulatory Differences</title></head><body>
<div style="text-align: center;"><big><big><big><big><big><span style="font-weight: bold;"></span></big></big></big></big></big><img style="width: 750px; height: 391px;" alt="" src="bird.jpg">
</div>

<div style="text-align: center;">
<small style="font-style: italic; color: rgb(150, 150, 150);">Photo by
Bill Majoros.&nbsp; Used with permission.</small><br>
<big><big>
</big></big></div>

<hr style="width: 100%; height: 2px;"><big><big> </big></big><big><big><br>
</big></big>
<div style="text-align: center;">
<table style="text-align: left; width: 70%; margin-left: auto; margin-right: auto;" border="1" cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">
      <div style="text-align: center;"><span style="color: red;"><br>
      <big><big><big>NEWS<br>
      </big></big></big><br>
      </span></div>
      <ul>
        
        <li style="text-align: justify;"><big><big><span style="font-weight: bold;">[8/23/2018] Experiment design web tool released </span>- A web tool is now available for power and sample size estimation:  <a href="http://67.159.92.22:8080/" target="_blank">http://67.159.92.22:8080/</a><span style="font-weight: bold;"><br>
          </span></big></big></li>
        <li style="text-align: justify;"><big><big><span style="font-weight: bold;">[6/16/2018]
First version of BIRD released</span>
- The first version of BIRD has been released on GitHub at <a href="https://github.com/bmajoros/BIRD" target="_blank">https://github.com/bmajoros/BIRD</a>.<span style="font-weight: bold;"><br>
          </span></big></big></li>

        
      </ul>
      </td>
    </tr>
  </tbody>
</table>
<br>
</div>

<big><big><br>
</big></big>
<hr style="width: 100%; height: 2px;"><big><big><br>
</big></big>
<div style="text-align: center;"><big><big style="font-weight: bold;"><big>Contents</big></big></big><br>
<small><small><small>&nbsp;</small></small></small><br>
<a href="#Description"><big><big>Description</big></big></a><br>
<big><big><a href="#Download">Download</a></big></big><br>
<big><big><a href="#Installation">Installation</a><br>
</big></big><big><big><a href="#Running">Running</a><br>
<a href="#outputformat">Output Format</a><br>
<a href="#examples">Examples</a><br>
<a href="#webtool">Web Tool</a><br>
</big></big>
<big><big><a href="#Contact">Contact</a></big></big><br>
</div>

<big><big><br>
</big></big>
<hr style="width: 100%; height: 2px;"><big><big><br>
</big></big>
<table style="margin-left: auto; margin-right: auto; width: 80%; text-align: left;" border="0" cellpadding="2" cellspacing="2">

  <tbody>
    <tr>
      <td style="vertical-align: top;">
      <h1><a name="Description"></a><big><big>Description</big></big></h1>
      <div style="text-align: justify;"><big><big><br>
      </big></big><big><big>BIRD (<span style="font-style: italic;">Bayesian
Inference of Regulatory Differences</span>)
is a software suite for identifying regulatory variants in data from
STARR-seq and other massively parallel reporter
assays (MPRAs).&nbsp;&nbsp; BIRD uses a Bayesian hierarchical model to
integrate prior information with read count data.&nbsp; Using MCMC (<span style="font-style: italic;">Markov Chain Monte Carlo</span>),
BIRD efficiently performs posterior inference to estimate effect sizes
of regulatory variants.&nbsp; Because BIRD's inference is based on
posterior distributions, it is able to provide both point estimates and
credible intervals for effect sizes.&nbsp; BIRD has been found to be
substantially more accurate than other tests based on the beta-binomial
distribution and Fisher's exact test.</big></big><br>
      </div>
      <big><big><br>
      </big></big>
      <div style="text-align: center;"><img style="width: 549px; height: 443px;" alt="" src="model.jpg"><br>
      </div>
      <big><big><br>
      </big></big>
      <div style="text-align: justify;"><big><big>The purpose of BIRD is to estimate the effect size of regulatory variants, where the effect size, <span style="font-style: italic;">theta</span>, is defined as:<br>
      <br>
</big></big>
      <div style="text-align: center;"><img style="width: 598px; height: 104px;" alt="" src="theta.jpg"><br>
      </div>
      <big><big><br>
Thus, an effect size of 1 means that the variant has no effect on
transcription.&nbsp; Effect sizes less than 1 mean that the alternate
allele reduces transcription, while effects greater than 1 mean that
the alternate allele increases transcription.&nbsp; Effect sizes tend
to range between 0.5 and 2.0.<br>
      <br>
BIRD explicitly models the unknown allele frequency <span style="font-style: italic;">p</span> in the DNA and <span style="font-style: italic;">q</span> in the RNA, as well as the individual frequencies <span style="font-style: italic;">q<sub>i</sub></span> in each biological replicate.&nbsp; BIRD computes an effect size (<span style="font-style: italic;">theta</span>) from these latent variables <span style="font-style: italic;">p</span> and <span style="font-style: italic;">q</span>,
rather than simply dividing read counts.&nbsp; The common method of
dividing read counts results in unstable estimates when read counts are
low.&nbsp; BIRD's use of an informative prior on effect sizes results
in more stable estimates when read counts are low.&nbsp; In addition,
BIRD's explicit modeling of replicate structure improves its estimate
of allele frequencies in RNA, thus providing more accurate estimates of
regulatory effect size.&nbsp; Finally, because BIRD reconstructs the
full posterior distribution of theta (the effect size), it can assess
how confident its estimate of theta is.&nbsp; This confidence is
reported to the user as a 95% credible interval, as well as a posterior
probability, <span style="font-style: italic;">P<sub>reg</sub></span>, that the variant has a regulatory effect.<br><br>
BIRD is written in open-source STAN, C++, and python, and can be compiled
on most UNIX systems.&nbsp; BIRD is was developed
in the Center for Statistical
Genetics and Genomics at Duke University.</big></big><br>
      <big><big>&nbsp;&nbsp;&nbsp; </big></big><br>
      </div>
      <div style="text-align: justify;"><big><big>&nbsp;&nbsp;&nbsp;&nbsp;
      </big></big><br>
      </div>
      <big><big><br>
      </big></big>
      <hr style="width: 100%; height: 2px;">
      <h1><a name="Download"></a><big><big>Download</big></big><br>
      </h1>
      <div style="text-align: justify;"><big><big>BIRD can be
downloaded from GitHub:</big></big><br>
      </div>
      <big><big><br>
      </big></big>
      <div style="text-align: center;"><big><big><a href="https://github.com/bmajoros/BIRD" target="_blank">https://github.com/bmajoros/BIRD</a>
      </big></big><br>
      </div>
      <br>
      <div style="text-align: justify;"><big><big>BIRD is designed to
run on Linux<a href="#Docker"></a>.&nbsp;
Installation instructions are provided below.</big></big><br>
      </div>
      <big><big><br>
<br>
      </big></big>
      <hr style="width: 100%; height: 2px;">
      <h1><a name="Installation"></a><big><big>Installation</big></big></h1>
      <div style="text-align: justify;">
      <h3><big><big>Prerequisites for Installing BIRD<br>
      </big></big></h3>
      <big><big>The following are required to
install and run BIRD directly on your system:<br>
      </big></big>
      <ul>
        <li><big><big>BIRD has been tested on <span style="font-weight: bold;">Linux</span><span style="font-weight: bold;"></span>.&nbsp; It may or may not work
on other UNIX systems.<br>
          </big></big></li>
        <li><big><big>Installation must be on a <span style="font-weight: bold;">case-sensitive filesystem</span>.</big></big></li>
        <li><big><big><a href="http://mc-stan.org/users/interfaces/cmdstan.html" target="_blank">CmdStan</a>
must be installed.&nbsp; This is the command-line interface to the STAN
statistical programming language.</big></big></li>
        <li><big><big><a href="https://gcc.gnu.org/" target="_blank">g++/gcc</a> version 6.2 or higher is required.<br>
          </big></big></li>

        <li><big><big><a href="https://www.python.org/" target="_blank">Python</a>
version 3.5 or higher is required.</big></big></li>
        <li><big><big><a href="https://www.gnu.org/software/gsl/" target="_blank">GSL</a>, the Gnu Scientific Library, must be installed.<br>
          </big></big></li>
      </ul>
      
      <h3><big><big>Installing and Compiling BIRD Source Code</big></big></h3>
      <big><big>First, install <a href="http://mc-stan.org/users/interfaces/cmdstan.html" target="_blank">CmdStan</a>, and set the environment variable <code>$STAN</code>
to the directory where CmdStan has been installed.&nbsp; In
the bash shell, this can be done using a command of the form: <br>
      <br>
      <code>export STAN=/full/absolute/path/to/cmdstan</code><br>
      </big></big> </div>
      <big><big><br></big></big>
      <div style="text-align: justify;"><big><big>
Next, download BIRD, copy its files into the CmdStan directory, and
compile BIRD in the CmdStan directory, using these commands:</big></big><br>
      </div>
      <big><big>
      <br>
      <code>git clone --recursive \<br>
&nbsp; https://github.com/bmajoros/BIRD.git<br>cd BIRD<br>
make all<br>
cp swift *.{stan,py} $STAN<br>
cd $STAN<br>
make BIRD<br>
      </code></big></big><big><big><span style="text-decoration: underline; color: rgb(153, 0, 0); font-weight: bold;"><a name="PATH"></a></span><span style="color: rgb(153, 0, 0);"></span></big></big><big><big><span style="color: rgb(153, 0, 0);"></span><br>
Next, please set these additional environment variables:<br>
      </big></big>
      <ul>
        <li style="text-align: justify;"><big><big><code>$TMPDIR</code> : absolute path to a
location where temporary files can be made (this might already be set
by your system administrator)<br>
          </big></big></li>
        <li style="text-align: justify;"><big><big><code>$BIRD</code> : absolute path to the BIRD
directory created above by the <code>git clone</code> command<br>
          </big></big></li>
        <li style="text-align: justify;"><big><big><span style="font-family: monospace;">$PYTHONPATH</span>
: absolute path to the <span style="font-family: monospace;">$BIRD/python</span>
subdirectory</big></big></li>
        <li style="text-align: justify;"><big><big>All environment variables documented in the <a href="https://www.gnu.org/software/gsl/" target="_blank">GSL</a> distribution.&nbsp; These include <span style="font-family: monospace;">$GSLDIR</span> and possibly others.<br>
          </big></big></li>

      </ul>
      <div style="text-align: justify;"><big><big>If you use the <span style="font-family: monospace;">tcsh</span> or <span style="font-family: monospace;">csh</span> shells, this can be done
using the <span style="font-family: monospace;">setenv</span> command;
if your shell is <span style="font-family: monospace;">bash</span>,
you'll need to use the <span style="font-family: monospace;">set</span>
and <span style="font-family: monospace;">export</span>
commands.&nbsp; It is recommended to put these commands in your <span style="font-family: monospace;">.cshrc</span> or <span style="font-family: monospace;">.bashrc</span> file so they run every
time you log in.&nbsp; Note that your system administrators may have
already set <code>$TMPDIR</code> for you.</big></big><br>
      </div>
      
      <div style="text-align: justify;"><big><big><br>
</big></big></div><big><big>
      </big></big><br>
      <hr style="width: 100%; height: 2px;">
      <h1><a name="Running"></a><big><big>Running BIRD<br>
      </big></big></h1>
      <h3><big><big>Prerequisites<br>
      </big></big></h3>
      <div style="text-align: justify;"><big><big>Before the BIRD model
can be run, you must create a file containing the read counts for each
genetic variant.&nbsp; The format of this required file is described
below.<br>
      <br>
To obtain read counts, you will first need to align your sequencing reads
using an aligner such as <a href="http://bowtie-bio.sourceforge.net/index.shtml" target="_blank">Bowtie</a>.&nbsp;
Once your reads are aligned, you can use the <a href="http://www.htslib.org/" target="_blank">samtools</a> <code>mpileup</code>
command to get read counts for each genetic variant.&nbsp; You can then
put those read counts into an input file for BIRD.&nbsp; The format of
the input file is described next.<br>
      </big></big></div>
      <big><big><br>
      </big></big>
      <h3><big><big>Input Format</big></big></h3>
      
      <div style="text-align: justify;"><big><big>The input file for BIRD must contain one line per
genetic variant.&nbsp; Each line consists of tab-separated columns.</big></big><br>
      </div>
      <big><big>
      <br><a name="nov"></a>
The first two columns are:<br>
      </big></big>
      <ul>
        <li><big><big><span style="font-style: italic;">ID</span> = identifier of the variant.&nbsp;&nbsp; For example, rs847362.<span style="color: rgb(153, 0, 0);"></span><br>
</big></big></li><li style="text-align: justify;"><big><big><span style="font-style: italic;">D</span> =
number of DNA replicates.&nbsp; This should be an integer.&nbsp; If you
only sequenced your DNA once, set this to 1.</big></big></li>
      </ul>
      
      <div style="text-align: justify;"><big><big>The next set of columns consists of pairs of reference
and alternate read counts in the DNA.&nbsp; The number of such pairs is
given by <span style="font-style: italic;">D</span>.&nbsp; Thus, if
you did 3 DNA replicates, you will have six columns after the <span style="font-style: italic;">D</span> column:</big></big><br>
      <big><big>
      </big></big></div>

      <ul>
        <li><big><big>Read count for reference allele in DNA replicate 1</big></big></li>
        <li><big><big>Read count for alternate allele in DNA replicate 1</big></big></li>
        <li><big><big>Read count for reference allele in DNA replicate 2</big></big></li>
        <li><big><big>Read count for alternate allele in DNA replicate 2</big></big></li>
        <li><big><big>Read count for reference allele in DNA replicate 3</big></big></li>
        <li><big><big>Read count for alternate allele in DNA replicate 3</big></big></li>
      </ul>
      
      <div style="text-align: justify;"><big><big>If you have more than
3 replicates, continue alternating reference and alternate allele
counts as above, separating all columns by tabs.</big></big><br>
      <br>
      <big><big>Next is column <span style="font-style: italic;">R</span>, which
specifies the number of RNA replicates.</big></big><br>
      <big><big>
      </big></big><br>
      <big><big>
Finally, this is followed by <span style="font-style: italic;">R</span>
pairs of reference and alternate read counts in the RNA, just as for
the DNA above.</big></big><br>
      <big><big>
      </big></big><br>
      <big><big>
Thus, an example line for 1 DNA replicate and 3 RNA replicates would be as follows (<span style="text-decoration: underline;">NOTE</span>: do not include the header line in your input file):</big></big><br>
      </div>
      <big><big>
      <br><small><code><span style="text-decoration: underline;">ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D&nbsp; ref&nbsp;
alt&nbsp; R&nbsp; ref&nbsp; alt ref&nbsp; alt ref&nbsp; alt</span><br style="text-decoration: underline;">
variant1&nbsp; 1&nbsp; 101&nbsp; 99&nbsp;&nbsp; 3&nbsp;
110&nbsp; 89&nbsp; 114&nbsp; 84&nbsp; 109&nbsp; 82<br>
      </code></small> </big></big><br>
      
      <div style="text-align: justify;"><big><big>The <code>example-inputs.txt</code> file in the <span style="font-family: monospace;">$BIRD</span> directory provides additional examples.</big></big><br>
      </div>
      <big><big><br>
      <br>
      </big></big>
      
      <h3><big><big><big><big>Running the Model</big></big></big></big></h3>
<br>
      
      <div style="text-align: justify;"><big><big>The model must be run in the <code>$STAN</code> directory.&nbsp; The following command will run the model on a set of variants:</big></big><br>
      </div>
      <big><big>
      <br>
      <code>bird.py BIRD lambda input.txt stan.txt samples first-last &gt; out.txt<br>
      </code><br>
The parameters are:<br>
      </big></big>
      <ul style="text-align: justify;">
        <li><big><big><code>BIRD</code> = the model to use; set this to "BIRD" (no quotes).<br>
</big></big></li>
        <li><big><big><span style="font-family: monospace;">lambda</span> = the minimum effect size to include in posterior calculations.&nbsp; We recommend setting this to <span style="font-family: monospace;">1.25</span>, which will calibrate posterior probabilities for detecting effects larger than 1.25 or less than 1/1.25.&nbsp;
The minimum value for this parameter is 1.&nbsp; This parameter does
not affect the estimated effect size or credible interval.<br>
          </big></big></li>

        <li><big><big><code>input.txt</code> = the genetic variants to test, one line per variant, as described above.</big></big></li>
        <li><big><big><code>stan.txt</code> = the name of a file that BIRD can use to store outputs from the STAN engine.</big></big></li>
        <li><big><big><code>samples</code> = the number of MCMC samples to draw.&nbsp; We recommend 1000.&nbsp; If speed is crucial, you can set this to 500, or use the <a href="#swift"><span style="font-family: monospace;">swift</span></a> program instead (see below).</big></big></li>
        <li><big><big><code>first-last</code> = the range of variants
to process, in zero-based coordinates.&nbsp; If your input file
contains 50 variants, set this to 0-49 to process all 50
variants.&nbsp; You can use this parameter to split the variants across
multiple jobs, for parallelization.&nbsp; For example, to run 5 jobs,
you could use the ranges 0-9, 10-19, 20-29, 30-39, and 40-49.&nbsp; Be
sure to specify different output files and different temp files for the
different jobs.&nbsp; BIRD is not automatically parallelized; you will
need to run the separate jobs manually.<br>
          </big></big></li>
        <li><big><big><code>out.txt</code> = the output file where predictions will be written.</big></big></li>
      </ul>
      <div style="text-align: justify;"><big><big>An optional parameter is <span style="font-family: monospace;">-t thetas.txt</span>,
which will store the sampled values of theta (effect size) into the
given file, with all the samples for a single variant on a single line
separated by tabs.&nbsp; If you process multiple variants, the samples
for different variants will be on different lines, in the same order as
in the input file.<br>
      <br>
Note that the BIRD model relies on MCMC sampling, which can be
slow.&nbsp; To run on millions of variants with high allele frequencies (&gt;0.075), we recommend using the <a href="#swift">Swift</a>
model instead of BIRD.&nbsp; Swift is approximately 5000 times faster
than BIRD, while being only slightly less accurate for variants with
high allele frequencies; for allele frequencies less than 0.075, BIRD
tends to be more accurate.<br>
      </big></big></div>
      <br>

      
<br>
      <h3><big><big><a name="outputformat"></a>Output Format<br>
      </big></big></h3>
      <div style="text-align: justify;"><big><big>The output consists of 5 columns:<br>
</big></big>
      <ul>
        
        <li><big><big><span style="text-decoration: underline;">Variant ID</span> = identifier of the variant tested.<span style="text-decoration: underline;"><br>
          </span></big></big></li>
        <li><big><big><span style="text-decoration: underline;">Effect size (theta)</span>
= posterior median of effect size under the model.&nbsp; This effect
size can be interpreted as the transcriptional rate of the alternate
allele divided by the transcriptional rate of the reference
allele.&nbsp; An effect of 0.5 means that the alternate allele halves
the transcriptional rate.&nbsp; Effect sizes tend to be between 0.5 and
2 for real regulatory variants.&nbsp; An effect size close to 1 means no effect.</big></big></li>

        <li><big><big><span style="text-decoration: underline;">Lower CI</span> = lower bound of 95% credible interval.</big></big></li>
        <li><big><big><span style="text-decoration: underline;">Upper CI</span> = upper bound of 95% credible interval.</big></big></li>
        <li><big><big><span style="text-decoration: underline;">P<sub>reg</sub></span> = posterior probability that the variant has a regulatory effect.&nbsp; This probability reflects the <span style="font-family: monospace;">lambda</span> value specified in the BIRD command.&nbsp; If you specified 1.25 (as recommended), <span style="font-style: italic;">P<sub>reg</sub></span> will be the posterior probability that the effect size is greater than 1.25 or less than 1/1.25.<br>
          </big></big></li>
</ul>
      <big><big>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
      </big></big>
      </div>
      <br>
      <h3><big><big>Parallelizing BIRD on Your System<br>
      </big></big></h3>

      <big><big>
      </big></big>
      
      <div style="text-align: justify;"><big><big>Because BIRD processes
each variant individually, parallelization on different cluster computing
systems is simple, via batch processing of different sets of variants.&nbsp;
By splitting the full variant set into <span style="font-style: italic;">N</span> subsets (input files) and
submitting <span style="font-style: italic;">N</span> batch jobs to
process those files on <span style="font-style: italic;">N</span>
different compute nodes, processing can in theory achieve an <span style="font-style: italic;">N</span>-fold speedup.&nbsp; Be sure to specify different outputs files and different temp files for the different jobs.<br>
      </big></big></div>

      <big><big><br>
</big></big>
      
      <h3><big><big><a name="swift"></a>Running the Swift Model<br>
      </big></big></h3>


      <big><big>
      </big></big>
      <big><big>BIRD
can be slow when run on extremely large numbers of variants, due to its
use of MCMC sampling.&nbsp; A faster model that is typically only slightly
less accurate on common variants (maf&gt;0.075) is included in the BIRD package.&nbsp; It is called <span style="font-style: italic;">swift</span>, and has the same input and output file formats as BIRD.&nbsp; Swift can be run via the following command:<br>
<br>
<code>swift input.txt 100 lambda first-last 1000</code><br>
&nbsp;&nbsp; <br>
Where:<br>
</big></big>
      <ul>
<li><big><big><span style="font-family: monospace;">input.txt</span> is the input file, formatted the same as for BIRD.</big></big></li><li><big><big><span style="font-family: monospace;">lambda</span> (minimum effect size in posterior calculations) is defined the same as for BIRD: we recommend using 1.25.<br>
    </big></big></li><li><big><big><span style="font-family: monospace;">100</span> is a concentration parameter for the prior that shrinks <span style="font-style: italic;">q</span> toward <span style="font-style: italic;">p</span>; we have found 100 to work well on multiple data sets.</big></big></li><li><big><big><span style="font-family: monospace;">first-last</span> is the range of variant indices to process, as in BIRD.&nbsp; Indices are zero-based and inclusive.</big></big></li><li><big><big><span style="font-family: monospace;">1000</span> is the number of samples to draw.&nbsp; We have found 1000 samples to work well.</big></big></li>
      </ul>

      <big><big>If you want to save the individual MCMC samples to reconstruct the full posterior distribution for theta, you can use the <span style="font-family: monospace;">-s</span>
option with a filename.&nbsp; The samples for theta will be written into the
specified file.&nbsp; All samples of theta for a single variant will be on a
single line, separated by tabs.&nbsp; Samples for different variants will be
on separate lines.<br>
<br>
Swift has been found to be approximately 5000 times faster than BIRD,
making it practical for use on the largest of data sets.&nbsp; Note
that Swift tends to be less accurate than BIRD on rare/uncommon
variants (allele frequencies less than 0.075).</big></big><big><big><br>
      <br>
      <br>
<br>
      </big></big>
      <h3><big><big><big><big><a name="examples"></a>Example Inputs and Outputs<br>
</big></big></big></big></h3>
      <div style="text-align: justify;"><big><big>In the <code>$BIRD</code>
directory is a file containing 1000 genetic variants simulated to have an
effect size of 0.5, meaning that they reduce transcriptional rate by
half.&nbsp; BIRD can be run on this file using the following command in the STAN directory:</big></big><br>
      </div>
      <big><big><br>
      <code>bird.py BIRD 1.25 $BIRD/example-inputs.txt mcmc.txt 1000 0-499</code><br>
      <br>
      </big></big>
      <div style="text-align: justify;"><big><big>The input file contains 1000 lines, each line consisting of a single simulated variant.&nbsp; For example, the first line is:<br>
      <br>
      <code>variant1&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;
885&nbsp;&nbsp;&nbsp; 115&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp;
40&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 47&nbsp;&nbsp;&nbsp;
6&nbsp;&nbsp;&nbsp; 61&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;
75&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp; 88&nbsp;&nbsp;&nbsp;
5&nbsp;&nbsp;&nbsp; 101&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp;
112&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp; 124&nbsp;&nbsp;&nbsp;
9&nbsp;&nbsp;&nbsp; 140&nbsp;&nbsp;&nbsp; 7&nbsp;&nbsp;&nbsp;
149&nbsp;&nbsp;&nbsp; 11<br>
      </code><br>
      <span style="color: rgb(153, 0, 0);"></span><span style="color: black;">The
first field is the variant identifier ("variant1"), followed by the
number of DNA replicates, which is 1 here.&nbsp; After that come the
DNA read counts for the reference allele (885) and the alternate allele
(115).&nbsp; This is followed by the number of RNA replicates
(10).&nbsp; After that are pairs of fields giving the reference and
alternate read counts in the RNA.&nbsp; For the first RNA replicate
there were 40 reference and 0 alternate reads.&nbsp; For the second RNA
replicate, there were 47 reference and 6 alternate reads, etc...<br>
      </span><br>
Because BIRD uses a random sampling approach to inference, its outputs
will differ somewhat between runs.&nbsp; The outputs should be similar
to the lines shown below, but with slight differences due to sampling:</big></big><br>
      </div>
      <big><big><br>
      <code><span style="text-decoration: underline;">variant&nbsp;&nbsp; effect&nbsp; CI_left&nbsp; CI_right&nbsp; P<sub>reg</sub></span><br><span style="color: rgb(153, 0, 0);"><span style="color: black;">variant1&nbsp; 0.5513&nbsp; 0.3806 &nbsp; 0.8016 &nbsp;&nbsp; 0.974<br>
variant2&nbsp; 0.5868&nbsp; 0.4513 &nbsp; 0.8492&nbsp;&nbsp;&nbsp; 0.963<br>
variant3&nbsp; 0.5985&nbsp; 0.4441 &nbsp; 0.8284&nbsp;&nbsp;&nbsp; 0.963<br>
      </span><span style="color: black;">...etc...<br style="color: black;">
      </span><span style="color: black;"></span><br>
      </span></code></big></big><div style="text-align: justify;"><big><big>Since
these variants
were simulated to have an effect size of 0.5 (a halving of
transcriptional rate), we expect the estimated effect to be on the
order of 0.5, as they are here.&nbsp; However, because the model's
prior shrinks estimates toward 1 (i.e., no effect), estimates are
moderated toward 1 when the model is not highly confident of the
effect.&nbsp; Thus, for some variants in the example set, the estimate
will be higher than 0.5, due to shrinkage under the prior.<br>
      <br>
The <span style="font-style: italic;">P<sub>reg</sub></span> values (fifth column) indicate how confident the model is that there is a regulatory effect.&nbsp; If you specified a <span style="font-family: monospace;">lambda</span> value of 1.25 when running BIRD (as recommended), </big></big><big><big><span style="font-style: italic;">P<sub>reg</sub></span></big></big><big><big> will be the posterior probability that the effect size is greater than 1.25 or less than 1/1.25.  <br>
      <br>
To see that </big></big><big><big><span style="font-style: italic;">P<sub>reg</sub></span></big></big><big><big> values are indicative of  whether a variant has a regulatory effect, you can run BIRD on both positive examples in <span style="font-family: monospace;">example-inputs.txt</span>, and on a set of neutral variants included in the file <span style="font-family: monospace;">example-nulls.txt</span>:<br>
      <br>
      <span style="font-family: monospace;">bird.py BIRD 1.25 $BIRD/example-inputs.txt out-pos.tmp 1000 0-499 &gt; bird.pos<br>
      <br style="font-family: monospace;">
      </span><span style="font-family: monospace;">bird.py BIRD 1.25 $BIRD/example-nulls.txt out-neg.tmp 1000 0-499 &gt; bird.neg</span><br style="font-family: monospace;">
      <br>
Extracting the <span style="font-style: italic;">P<sub>reg</sub></span> values (fifth column of the output files) and plotting their distributions shows that for the regulatory variants, </big></big><big><big><span style="font-style: italic;">P<sub>reg</sub></span></big></big><big><big> is typically close to 1 (red distribution), whereas for neutral variants with no effect, </big></big><big><big><span style="font-style: italic;">P<sub>reg</sub></span></big></big><big><big> is typically close to 0 (blue distribution), as expected:<br>
      <br>
      </big></big>
      <div style="text-align: center;"><img style="width: 358px; height: 388px;" alt="" src="preg-plot.jpg"><br>
      </div>
      <big><big><br>
Plots like this can be generated in the </big></big><big><big><a href="https://www.r-project.org/" target="_blank">R statistical computing environment</a></big></big><big><big>, using commands such as the following:<br>
      <br>
      <code>pos &lt;- read.table("bird.pos")<br>
neg &lt;- read.table("bird.neg")<br>
dpos &lt;- density(pos$V5)<br>
dneg &lt;- density(neg$V5)<br>
plot(dpos,type="n")<br>
lines(dpos,col="red")<br>
lines(dneg,col="blue")<br>
      </code><br>
      <br>
      </big></big>
      <h3><big><big><big><big>Utilizing the full Posterior Distribution</big></big></big></big></h3>

      <big><big>While BIRD summarizes the posterior distribution of
theta (effect size) using the posterior median and the 95% credible
interval, advanced users may wish to reconstruct the full posterior
distribution of theta and extract other summary statistics.<br>
      <br>
If you used the <span style="font-family: monospace;">-t thetas.txt</span> option when running BIRD, then the samples of theta will be saved in the file <span style="font-family: monospace;">thetas.txt</span>.&nbsp;
The samples for each variant will be separated by tabs, with samples
for different variants on different lines (in the same order as the
input file).&nbsp; <br>
      <br>
You can load this data into the <a href="https://www.r-project.org/" target="_blank">R statistical computing environment</a>.&nbsp; To plot the distribution of theta values for the <span style="font-style: italic;">i</span><sup>th</sup> variant, you can use these R commands:<br>
      <br>
      <span style="font-family: monospace;">data &lt;- read.table("thetas.txt")</span><br style="font-family: monospace;">
      <span style="font-family: monospace;">hist(as.numeric(data[i,]))</span><br style="font-family: monospace;">
</big></big><big><big><br>
For example, the histogram below was constructed from the samples for one of the variants in the <span style="font-family: monospace;">example-inputs.txt</span> file.&nbsp; As you can see, the peak of the distribution is close to the true value of 0.5:<br>
      <br>
      </big></big>
      <div style="text-align: center;"><img style="width: 313px; height: 357px;" alt="" src="theta-histogram.jpg"><br>
      </div>
      <big><big><br>
      </big></big></div>
      
      <div style="text-align: justify;"><big><big>However, this
distribution has a large variance, indicating that the model is not
certain that theta is precisely equal to 0.5.&nbsp; The 95% credible
interval reported in the BIRD output (<span style="font-family: monospace;">CI_left</span> and <span style="font-family: monospace;">CI_right</span>)
gives the symmetric interval containing 95% of the MCMC samples, and
indicates the amount of spread in the distribution.&nbsp; Using the
full distribution as illustrated above, you can extract other credible
intervals as desired, or compute arbitrary tail probabilities.<br>
      <br>
For example, an estimate of P(theta&lt;=0.5) for the first</big></big><big><big> variant in the input file can be obtained in R using these commands:<br>
      </big></big><big><big><br>
<span style="font-family: monospace;">data &lt;- read.table("thetas.txt")</span><br style="font-family: monospace;">
<span style="font-family: monospace;">sum(data[1,]&lt;=0.5)/ncol(data)<br>
</span></big></big><big><big><br>
which in this case gives 0.264.&nbsp; Thus, the model assigns a degree
of belief of 26.4% that the variant reduces transcription by factor of
2 or more.<br>
      <br>
      </big></big></div>
      <big><big></big></big><div style="text-align: justify;"><big><big><br>
      </big></big>
      
      <h2><big><big><a name="webtool"></a>Web Tool for Experimental Design<br>
      </big></big></h2>



      <big><big>
      </big></big>
      <big><big>BIRD
can be used
to estimate required read depths and replicates to achieve a desired
sensitivity and false discovery rate (FDR).&nbsp; The web tool for
computing
these sample sizes is at:<br>
      <br>
      </big></big>
      <div style="text-align: center;"><big><big><a href="http://67.159.92.22:8080/" target="_blank">http://67.159.92.22:8080/</a></big></big><br>
      </div>
      <big><big>
      <br>
      </big></big>
      <div style="text-align: center;"><a href="http://67.159.92.22:8080/"><big><big><img style="border: 2px solid ; width: 535px; height: 569px;" alt="" src="webtool.jpg"></big></big></a><br>
      </div>
      <big><big><br>
      </big></big><big><big><br>
      </big></big><br>
      </div><hr style="width: 100%; height: 2px;">
      <h1><a name="Contact"></a><big><big>Contact</big></big></h1>
      <div style="text-align: justify;"><big><big>Please direct all bug
reports and feature requests to </big></big><big><big><a href="mailto:bmajoros@alumni.duke.edu">Bill Majoros</a></big></big><big><big>.<br>
      <br>
BIRD was developed by <a href="mailto:bmajoros@alumni.duke.edu">Bill
Majoros</a>
at Duke University
in collaboration with Andrew Allen and Tim Reddy.&nbsp; The web tool
was developed by Alex Barrera and </big></big><big><big>Young-Sook Kim </big></big><big><big>at Duke University.</big></big><br>
      </div>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
  </tbody>
</table>

<big><big><br>
</big></big><big><big><br>
</big></big><br>

<hr style="width: 100%; height: 2px;">
<div style="text-align: center;"><br>
contact: <a href="mailto:bmajoros@alumni.duke.edu">bmajoros@alumni.duke.edu</a><br>
<span style="font-style: italic;"><br>
</span><span style="font-style: italic;">Eagle photo by Bill
Majoros.&nbsp; Used with permission.</span><br>
</div>

</body></html>