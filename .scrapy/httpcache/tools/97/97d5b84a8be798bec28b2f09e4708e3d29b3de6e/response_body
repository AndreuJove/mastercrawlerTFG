<html>
  <head>
    <title>Barcode application</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script> 
    $(document).ready(function(){
      $("#panel").hide();
      $("#flip").click(function(){
        $("#panel").slideToggle("slow");
      });
    });
    </script>
 
    <style>
    body {
      font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
      background-image:url('./blue-background-wallpaper.jpg');
      background-size:100%,100%;
    }	 
    #flip
    {
      padding:3px;
      text-align:left;
      border: 0;
    }
    #panel
    {
      display:none;
      border: 0;
    }
    </style>

  </head>
  <body>
  <div id="left" style="width:15%;height:100%;float:left"></div>
  <div id="left2" style="width:2%;height:150%;float:left;background-color: white"></div>
  <div id="center" style="width:66%;height:150%;float:left;background-color: white" align="left">
  <center><img src="./barcosel_logo.png" id="barcode" width="30%"></center><br>
  <p>BARCOSEL is a web tool for selecting an optimal set of barcode sequences. User must provide a set of candidate barcodes from which the defined number of barcodes is selected. BARCOSEL utilizes mixed-integer linear programming software <a href="http://lpsolve.sourceforge.net/5.5/">lpsolve</a>.<br><br>More information and options can be found under button "Advanced" and hovering mouse over <img src="./info.png" id="info"> icons.
</p>
  <p>General description <span title="Output page of BARCOSEL gives a FASTA file which contains the selected
barcodes. In the output, there is also a graphical diagnostic plot which
shows the position-wise and global nucleotide balance within a selected
set.

Selection of barcodes is based on two criteria:

  1) Each barcode must be at least a user-defined number of nucleotide
mismatches apart from each other. This is a strict requirement. The
default number (threshold for minimum Hamming distance) is 3. In order
to tolerate M sequencing errors and still detect the correct barcode,
minimum barcode distance must be 2M+1. That is, with the default
threshold 3 it is guaranteed that one sequencing error can be corrected
for each barcode.
  2) The proportion of nucleotides in an optimal barcode set should be
in as good balance as possible. This is the goal of the optimization
process. Objective function includes both the global and the
position-wise nucleotide balances. In addition to single nucleotides
A,C,G,and T, also balance between two nucleotide groups (A,C) vs (G,T)
is maximized because of Illumina's nucleotide detection system.

Please note that both the content of candidate barcode sequences and the
number of barcodes to be selected affects how well the optimization
criteria can be satisfied:
  1) If no set of barcodes can be found for which the Hamming distance
between all barcode pairs is above or equal the given threshold, an
error message is given to user.
  2) Optimal position-wise nucleotide balance depends on the number of
barcodes to be selected. Only when it is a multiple of four, there can
be an equal number of A,C,G,and T in every barcode position resulting in
perfect balance. In this case also the solution is found fast.

Selecting an optimal set of barcodes is a combinatorial problem. We use
mixed-integer linear programming approach. The details can be found in
the manuscript."><img src="./info.png" id="info"></span> with full information <a href="./info.txt" target=_blank>here</a>.</p>
  <form name="barform"id="barform" action="http://ekhidna2.biocenter.helsinki.fi/cgi-bin/barcode/barcode.cgi" method="post" enctype="multipart/form-data">
  Enter barcode candidate sequences in FASTA format: <span title="Barcode candidates should be in multi-FASTA format where each barcode sequence is in a single line right after the line containing the barcode identifier. E.g.
>id1
ACCAAGGT
>id2
CGGATTAC
...
The length of the barcode sequence must be the same for all candidates. For practical reasons, the length of the barcode sequence should be less than 256 nucleotides. The number of candidate sequences is limited to 4000."><img src="./info.png" id="info"></span><br>
  <textarea name="query" cols="60" rows="8"></textarea><br><br>
  or upload a FASTA file: <INPUT TYPE="file" NAME="filex"><span title="multi-FASTA file format. The length (<256bp) of the barcode sequence must be the same for all candidates."><img src="./info.png" id="info"></span>
<br>
  <a href="./index288.txt" target=_blank>Example barcode candidate set</a>
<br><br>
  Number of barcodes to be selected: <input type="text" name="count" size="3"><span title="Number of selected barcodes must be at least 1 and at most the number of barcodes in a candidate set."><img src="./info.png" id="info"></span><br><br>


  <div id="flip"><button type="button">Advanced</button></div>
  <div id="panel">
  <p>Initial barcodes FASTA file: <INPUT TYPE="FILE" NAME="init"><span title="Optional initial barcode set which will be expanded."><img src="./info.png" id="info"></span></p>
  <p>Type of distance: 
	<input type="radio" name="distance" value="1" checked> Hamming
         <input type="radio" name="distance" value="2"> Levenshtein<br>

  <p>Minimum distance: <input type="text" name="hamming" size="3" value="3"><span title="Minimum number of nucleotide mismatches between two barcode sequences. In order to tolerate M sequencing errors and still detect the correct barcode, minimum barcode distance must be 2M+1. That is, default threshold 3 allows one sequencing error to be corrected."><img src="./info.png" id="info"></span></p>
  <p>Time limit in seconds: <input type="text" name="time" size="3" value="10"><span title="Maximum time for searching optimal solution. Usually, when perfect solution exists, it is found within a few seconds. If the time limit is exceeded, the best possible solution so far found is returned. Increase the maximum time if you think the better solution should exist and the optimum was not found with default parameters. In this case you might also want to try restricting maximum depth of the search and change basis crash value.

Due how the search engine works, sometimes the search is continued even when the global optimum is found. This is the case when the number of selected barcodes is not multiple of four, since in this case the perfect nucleotide balance doesn't exist and the cost function cannot be zero. In this case the algorithm spends the maximum allowed time."><img src="./info.png" id="info"></span></p>
  <p>Maximum depth of the search: <input type="text" name="deep" size="3" value="0"><span title="This is a parameter of lpsolve. Default is 0 which means there are no restrictions to branch&bound search depth. You can limit this (e.g. try 20) if you did not get optimal solution with default values. The effect is to explore wider search area in a given time limit. When you change this parameter, you might also want to increase the time limit."><img src="./info.png" id="info"></span></p>
  <p>Basis crash: <select name="crash">
	<option value="0" selected="selected">0</option>
	<option value="2">2</option>
	<option value="3">3</option>
	</select><span title="This is a parameter of lpsolve. Values are for different initializations for the lpsolver. Try different values if you were not happy with the previous results and you think there should be anyway a better solution among your candidate barcodes."><img src="./info.png" id="info"></span></p>
  <input type="hidden" name="folder" value=""> 
  <input type="hidden" name="iter" value=0>
  </div><br>
  <input type="reset" value="Clear">
  <input type="submit" name="Submit" value="Submit">
  </form>
  <br>
  <small>
Panu Somervuo, Patrik Koskinen, Peng Mei, Liisa Holm, Petri Auvinen, Lars Paulin (2018) <A HREF="https://rdcu.be/2Z1p">BARCOSEL: a tool for selecting an optimal barcode set for high-throughput sequencing</A>. BMC Bioinformatics 19:257.

</small><br><br><br>
<script type="text/javascript" src="//ra.revolvermaps.com/0/0/4.js?i=0ksbqbdcegx&amp;m=0&amp;h=128&amp;c=ff0000&amp;r=0" async="async"></script>
  <!--center--><img src="./print-logo.png" id="logo" width="30%"></center>
  </div>
  <div id="right2" style="width:2%;height:150%;float:left;background-color: white"></div>
  <div id="right" style="width:15%;height:100%;float:left"></div>
  </body>
</html>
