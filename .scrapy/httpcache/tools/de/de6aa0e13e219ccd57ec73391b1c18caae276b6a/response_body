<!DOCTYPE html>
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <script type="application/shiny-singletons">b8d79706b067e925accf37c2d5d6cf4524fed520</script>
  <script type="application/html-dependencies">json2[2014.02.04];jquery[1.12.4];shiny[1.3.2];selectize[0.11.2];datatables[1.10.5];datatables-bootstrap[1.10.5];bootstrap[3.3.7]</script>
<script src="shared/json2-min.js"></script>
<script src="shared/jquery.min.js"></script>
<link href="shared/shiny.css" rel="stylesheet" />
<script src="shared/shiny.min.js"></script>
<link href="shared/selectize/css/selectize.bootstrap3.css" rel="stylesheet" />
<!--[if lt IE 9]>
<script src="shared/selectize/js/es5-shim.min.js"></script>
<![endif]-->
<script src="shared/selectize/js/selectize.min.js"></script>
<script src="shared/datatables/js/jquery.dataTables.min.js"></script>
<link href="shared/datatables/css/dataTables.bootstrap.css" rel="stylesheet" />
<link href="shared/datatables/css/dataTables.extra.css" rel="stylesheet" />
<script src="shared/datatables/js/dataTables.bootstrap.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="shared/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="shared/bootstrap/js/bootstrap.min.js"></script>
<script src="shared/bootstrap/shim/html5shiv.min.js"></script>
<script src="shared/bootstrap/shim/respond.min.js"></script>  <link rel="stylesheet" type="text/css" href="bootstrap.min.css"/>
  <style>.shinyjs-hide { display: none !important; }</style>
  <script>Shiny.addCustomMessageHandler('shinyjs-show', function(params) { shinyjs.debugMessage('shinyjs: calling function "show" with parameters:'); shinyjs.debugMessage(params); shinyjs.show(params);});
Shiny.addCustomMessageHandler('shinyjs-hide', function(params) { shinyjs.debugMessage('shinyjs: calling function "hide" with parameters:'); shinyjs.debugMessage(params); shinyjs.hide(params);});
Shiny.addCustomMessageHandler('shinyjs-toggle', function(params) { shinyjs.debugMessage('shinyjs: calling function "toggle" with parameters:'); shinyjs.debugMessage(params); shinyjs.toggle(params);});
Shiny.addCustomMessageHandler('shinyjs-enable', function(params) { shinyjs.debugMessage('shinyjs: calling function "enable" with parameters:'); shinyjs.debugMessage(params); shinyjs.enable(params);});
Shiny.addCustomMessageHandler('shinyjs-disable', function(params) { shinyjs.debugMessage('shinyjs: calling function "disable" with parameters:'); shinyjs.debugMessage(params); shinyjs.disable(params);});
Shiny.addCustomMessageHandler('shinyjs-toggleState', function(params) { shinyjs.debugMessage('shinyjs: calling function "toggleState" with parameters:'); shinyjs.debugMessage(params); shinyjs.toggleState(params);});
Shiny.addCustomMessageHandler('shinyjs-addClass', function(params) { shinyjs.debugMessage('shinyjs: calling function "addClass" with parameters:'); shinyjs.debugMessage(params); shinyjs.addClass(params);});
Shiny.addCustomMessageHandler('shinyjs-removeClass', function(params) { shinyjs.debugMessage('shinyjs: calling function "removeClass" with parameters:'); shinyjs.debugMessage(params); shinyjs.removeClass(params);});
Shiny.addCustomMessageHandler('shinyjs-toggleClass', function(params) { shinyjs.debugMessage('shinyjs: calling function "toggleClass" with parameters:'); shinyjs.debugMessage(params); shinyjs.toggleClass(params);});
Shiny.addCustomMessageHandler('shinyjs-html', function(params) { shinyjs.debugMessage('shinyjs: calling function "html" with parameters:'); shinyjs.debugMessage(params); shinyjs.html(params);});
Shiny.addCustomMessageHandler('shinyjs-onevent', function(params) { shinyjs.debugMessage('shinyjs: calling function "onevent" with parameters:'); shinyjs.debugMessage(params); shinyjs.onevent(params);});
Shiny.addCustomMessageHandler('shinyjs-alert', function(params) { shinyjs.debugMessage('shinyjs: calling function "alert" with parameters:'); shinyjs.debugMessage(params); shinyjs.alert(params);});
Shiny.addCustomMessageHandler('shinyjs-logjs', function(params) { shinyjs.debugMessage('shinyjs: calling function "logjs" with parameters:'); shinyjs.debugMessage(params); shinyjs.logjs(params);});
Shiny.addCustomMessageHandler('shinyjs-runjs', function(params) { shinyjs.debugMessage('shinyjs: calling function "runjs" with parameters:'); shinyjs.debugMessage(params); shinyjs.runjs(params);});
Shiny.addCustomMessageHandler('shinyjs-reset', function(params) { shinyjs.debugMessage('shinyjs: calling function "reset" with parameters:'); shinyjs.debugMessage(params); shinyjs.reset(params);});
Shiny.addCustomMessageHandler('shinyjs-delay', function(params) { shinyjs.debugMessage('shinyjs: calling function "delay" with parameters:'); shinyjs.debugMessage(params); shinyjs.delay(params);});
Shiny.addCustomMessageHandler('shinyjs-click', function(params) { shinyjs.debugMessage('shinyjs: calling function "click" with parameters:'); shinyjs.debugMessage(params); shinyjs.click(params);});</script>
  <script src="shinyjs/shinyjs-default-funcs.js"></script>
  <script>shinyjs.debug = false;</script>
  <title>checkMyIndex</title>

<script src="__assets__/sockjs-0.3.4.min.js"></script>
<script src="__assets__/shiny-server-client.min.js"></script>
<script>preShinyInit({reconnect:true,disableProtocols:[]});</script>
<link rel="stylesheet" type="text/css" href="__assets__/shiny-server.css"/>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-119360876-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>
  <div class="container-fluid">
    <h2>
      <div>
        <img src="dna.png" width="50"/>
        <strong>Search for a set of compatible indexes for your sequencing experiment</strong>
      </div>
    </h2>
    <div class="row">
      <div class="col-sm-4">
        <form class="well">
          <div id="allParameters">
            <div data-display-if="!output.testdataProvided" data-ns-prefix="">
              <div class="form-group shiny-input-container">
                <label>Select your tab-delimited file containing the index 1 (i7) ids and sequences</label>
                <div class="input-group">
                  <label class="input-group-btn">
                    <span class="btn btn-default btn-file">
                      Browse...
                      <input id="inputFile" name="inputFile" type="file" style="display: none;" accept="text"/>
                    </span>
                  </label>
                  <input type="text" class="form-control" placeholder="No file selected" readonly="readonly"/>
                </div>
                <div id="inputFile_progress" class="progress progress-striped active shiny-file-input-progress">
                  <div class="progress-bar"></div>
                </div>
              </div>
            </div>
            <div data-display-if="!output.testdataProvided" data-ns-prefix="">
              <div class="form-group shiny-input-container">
                <label>Optional index 2 (i5) file for dual-indexing</label>
                <div class="input-group">
                  <label class="input-group-btn">
                    <span class="btn btn-default btn-file">
                      Browse...
                      <input id="inputFile2" name="inputFile2" type="file" style="display: none;" accept="text"/>
                    </span>
                  </label>
                  <input type="text" class="form-control" placeholder="No file selected" readonly="readonly"/>
                </div>
                <div id="inputFile2_progress" class="progress progress-striped active shiny-file-input-progress">
                  <div class="progress-bar"></div>
                </div>
              </div>
            </div>
            <div data-display-if="!output.inputFileProvided &amp; !output.inputFile2Provided" data-ns-prefix="">
              <div class="form-group shiny-input-container">
                <label class="control-label" for="testdata">Load test indexes</label>
                <div>
                  <select id="testdata" class="form-control"><option value="none" selected>None</option>
<option value="simple">24 indexes 1 (i7)</option>
<option value="dual">6 indexes 1 (i7) and 4 indexes 2 (i5)</option></select>
                  <script type="application/json" data-for="testdata">{}</script>
                </div>
              </div>
            </div>
            <div class="form-group shiny-input-container">
              <label class="control-label" for="chemistry">Illumina chemistry</label>
              <div>
                <select id="chemistry" class="form-control"><option value="4" selected>Four-channels (HiSeq &amp; MiSeq)</option>
<option value="2">Two-channels (NovaSeq, NextSeq &amp; MiniSeq)</option>
<option value="1">One-channel (iSeq 100)</option></select>
                <script type="application/json" data-for="chemistry">{}</script>
              </div>
            </div>
            <div data-display-if="output.i7i5sameLength" data-ns-prefix="">
              <div id="i7i5pairing" class="shiny-html-output"></div>
            </div>
            <div data-display-if="output.indexUploaded" data-ns-prefix="">
              <div id="nbSamples" class="shiny-html-output"></div>
            </div>
            <div data-display-if="output.indexUploaded" data-ns-prefix="">
              <div id="multiplexingRate" class="shiny-html-output"></div>
            </div>
            <div data-display-if="!output.indexUploaded2" data-ns-prefix="">
              <div class="form-group shiny-input-container">
                <label class="control-label" for="unicityConstraint">Constraint on the indexes (single-indexing only)</label>
                <div>
                  <select id="unicityConstraint"><option value="none" selected>None</option>
<option value="lane">Use each combination only once</option>
<option value="index">Use each index only once</option></select>
                  <script type="application/json" data-for="unicityConstraint" data-nonempty="">{}</script>
                </div>
              </div>
            </div>
            <div data-display-if="output.indexUploaded &amp; !output.indexUploaded2" data-ns-prefix="">
              <div class="form-group shiny-input-container">
                <div class="checkbox">
                  <label>
                    <input id="completeLane" type="checkbox"/>
                    <span>Directly look for a solution with the desired multiplexing rate</span>
                  </label>
                </div>
              </div>
            </div>
            <div data-display-if="output.indexUploaded &amp; !output.indexUploaded2" data-ns-prefix="">
              <div class="form-group shiny-input-container">
                <div class="checkbox">
                  <label>
                    <input id="selectCompIndexes" type="checkbox"/>
                    <span>Select compatible indexes before looking for a solution</span>
                  </label>
                </div>
              </div>
            </div>
            <div class="form-group shiny-input-container">
              <label class="control-label" for="nbMaxTrials">Maximum number of trials to find a solution</label>
              <div>
                <select id="nbMaxTrials"><option value="10" selected>10</option>
<option value="100">100</option>
<option value="1000">1000</option>
<option value="10000">10000</option></select>
                <script type="application/json" data-for="nbMaxTrials" data-nonempty="">{}</script>
              </div>
            </div>
            <button id="go" type="button" class="btn btn-default action-button">Search for a solution</button>
            <button id="reset" type="button" class="btn btn-default action-button">Reset parameters</button>
          </div>
        </form>
      </div>
      <div class="col-sm-8">
        <div class="tabbable">
          <ul class="nav nav-tabs shiny-tab-input" id="mainPanel" data-tabsetid="8629">
            <li class="active">
              <a href="#tab-8629-1" data-toggle="tab" data-value="inputIndexes">Input indexes</a>
            </li>
            <li>
              <a href="#tab-8629-2" data-toggle="tab" data-value="proposedSolution">Proposed flowcell design</a>
            </li>
            <li>
              <a href="#tab-8629-3" data-toggle="tab" data-value="Visualization of the design">Visualization of the design</a>
            </li>
            <li>
              <a href="#tab-8629-4" data-toggle="tab" data-value="Help">Help</a>
            </li>
          </ul>
          <div class="tab-content" data-tabsetid="8629">
            <div class="tab-pane active" data-value="inputIndexes" id="tab-8629-1">
              <p>
                <div id="textIndex" class="shiny-text-output"></div>
              </p>
              <div id="inputIndex" class="shiny-datatable-output"></div>
              <p>
                <div id="textIndex2" class="shiny-text-output"></div>
              </p>
              <div id="inputIndex2" class="shiny-datatable-output"></div>
              <p>
                <div id="textPairingTable" class="shiny-text-output"></div>
              </p>
              <div id="pairingTable" class="shiny-datatable-output"></div>
            </div>
            <div class="tab-pane" data-value="proposedSolution" id="tab-8629-2">
              <div id="proposedSolution" class="shinyjs-hide">
                <p>
                  <div id="textDescribingSolution" class="shiny-text-output"></div>
                </p>
                <div id="solution" class="shiny-datatable-output"></div>
                <br></br>
                <div id="downloadButton" class="shiny-html-output"></div>
              </div>
            </div>
            <div class="tab-pane" data-value="Visualization of the design" id="tab-8629-3">
              <div id="visualization" class="shinyjs-hide">
                <p>
                  <div id="textDescribingHeatmap" class="shiny-text-output"></div>
                </p>
                <div id="heatmapindex2" class="shiny-html-output"></div>
              </div>
            </div>
            <div class="tab-pane" data-value="Help" id="tab-8629-4">
              <h3>Input indexes file(s)</h3>
              <p>
                The user must provide its available indexes as two-column tab-delimited text file(s) without header: index ids are in the first column
                                   and corresponding sequences in the second. An example of such a file is available into the GitHub repository and also 
                <a href="inputIndexesExample.txt" target="blank" download="inputIndexesExample.txt">here</a>
                 to test the application.
                                   Note that for dual-indexing sequencing experiments the first file corresponds to indexes 1 (i7) and the second file to indexes 2 (i5).
                                   Example files for dual-indexing are available 
                <a href="index24-i7.txt" target="blank" download="index24-i7.txt">here</a>
                 (index 1) and 
                <a href="index24-i5.txt" target="blank" download="index24-i5.txt">here</a>
                 (index 2).
              </p>
              <h3>How the algorithm works</h3>
              <p>There can be many combinations of indexes to check according to the number of input indexes and the multiplexing rate. Thus, testing for 
                                    the compatibility of all the combinations may be long or even impossible. The trick is to find a partial solution with the desired number 
                                    of pools/lanes but with fewer samples than asked and then to complete each pool/lane with some of the remaining indexes to reach the desired 
                                    multiplexing rate. Indeed, adding indexes to a combination of compatible indexes will give a compatible combination for sure. Briefly, a lower 
                                    number of samples per pool/lane generates a lower number of combinations to test and thus makes the research of a partial solution very fast. 
                                    Adding some indexes to complete each pool/lane is fast too and gives the final solution.</p>
              <p>Unfortunately, the research of a final solution might become impossible as the astuteness reduces the number of combinations of indexes.
                                    In such a case, one can look for a solution using directly the desired multiplexing rate (see parameters), the only risk is to increase 
                                    the computational time.</p>
              <h3>Parameters</h3>
              <p>
                <strong>Illumina chemistry</strong>
                can be either four-channels (HiSeq &amp; MiSeq), two-channels (NovaSeq, NextSeq &amp; MiniSeq) or one-channel (iSeq 100).
                                   With the four-channel chemistry, a red laser detects A/C bases and a green laser detects G/T bases and the indexes are compatible if there is at 
                                   least one red light and one green light at each position. With the two-channel chemistry, G bases have no color, A bases are orange, C bases are
                                   red and T bases are green and indexes are compatible if there is at least one color at each position. Note that indexes starting with GG are not
                                   compatible with the two-channel chemistry. With the one-channel chemistry, compatibility cannot be defined with colors and indexes are compatible
                                   if there is at least one A or C or T base at each position. Please refer to the Illumina documentation for more detailed information on the different
                                   chemistries.
              </p>
              <p>
                <strong>Total number of samples</strong>
                in your experiment (can be greater than the number of available indexes).
              </p>
              <p>
                <strong>Multiplexing rate</strong>
                i.e. number of samples per pool/lane (only divisors of the total number of samples are proposed).
              </p>
              <p>
                <strong>i7 and i5 pairing</strong>
                (only for dual-indexing) is proposed if there are as many i5 as i7 indexes to deal with Illumina Unique Dual-Indexes (UDI).
                                   Note that the pairing is done using the order of the indexes in the input files.
              </p>
              <p>
                <strong>Constraint on the indexes</strong>
                (only for single-indexing) to avoid having two samples or two pools/lanes with the same index(es).
              </p>
              <p>
                <strong>Directly look for a solution with the desired multiplexing rate</strong>
                (only for single-indexing) instead of looking for a partial solution 
                                           with a few samples per pool/lane and then add some of the remaining indexes to reach the desired multiplexing rate.
              </p>
              <p>
                <strong>Select compatible indexes</strong>
                (only for single-indexing) before looking for a (partial) solution can take some time but then speed up the algorithm.
              </p>
              <p>
                <strong>Maximum number of trials</strong>
                can be increased if a solution is difficult to find with the parameters chosen.
              </p>
              <h3>About</h3>
              <p>
                This application has been developed at the Biomics pole of the Institut Pasteur by Hugo Varet and an 
                <a href="https://doi.org/10.1093/bioinformatics/bty706">Application Note</a>
                describing it has been published in 2018 in Bioinformatics. Feel free to send an e-mail to
                <a>hugo.varet@pasteur.fr</a>
                for any suggestion or bug report.
              </p>
              <p>
                Source code and instructions to run it locally are available the
                <a href="https://github.com/PF2-pasteur-fr/checkMyIndex">GitHub</a>
                repository. 
                                   Please note that checkMyIndex is provided without any guarantees as to its accuracy.
              </p>
              <h3>Version</h3>
              <p>This website executes checkMyIndex version 1.0.2.</p>
              <div style="text-align: center;">
                <img src="logo_c3bi_citech.jpg" width="300"/>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>
