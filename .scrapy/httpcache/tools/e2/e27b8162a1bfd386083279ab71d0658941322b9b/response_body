<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CRUNCH - A completely automated pipe-line for ChIP-seq data analysis</title>

    <meta name="description" content="CRUNCH - A completely automated pipe-line for ChIP-seq data analysis,
                                      starting from raw sequencing reads, through quality filtering, read
                                      mapping, fragment size estimation, peak calling, peak annotation and
                                      comprehensive regulatory motif analysis.  It runs with data from
                                      human (hg19), mouse (mm9) or drosophila (dm3).">

    <meta name="keywords"    content="swissregulon, human, mouse, CRUNCH, ChIP-Seq, transcription factor, regulatory site,
                                      RNA-SEQ, CHIP-SEQ, Erik van,
                                      analysis pipeline,
                                      Nimwegen, gene regulation,
                                      regulatory genomics, Swiss
                                      Institute of Bioinformatics,
                                      data processing, Biozentrum
                                      University of Basel">

    <link rel="stylesheet" href="/js/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/js/jQuery-File-Upload/css/style.css">
    <link rel="stylesheet" href="/js/jQuery-File-Upload/css/jquery.fileupload-ui.css">
    <link rel="stylesheet" href="/sib_css/sib.css" type="text/css" media="screen">
    <link rel="stylesheet" href="/sib_css/sib_print.css" type="text/css" media="print">
  </head>

  <body>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-49924751-1', 'unibas.ch');
      ga('send', 'pageview');
    </script>

    <div class="container-fluid" style="margin-top: 1em;">
      <div class="row">
        <div class="col-lg-2">
          <a href="https://www.isb-sib.ch/">                
            <img src="/sib_images/sib_logo_141x75.gif" alt="SIB logo">
          </a>
        </div>
        <div class="col-lg-8 align-items-center">
          <h1 class="text-center">CRUNCH</h1>
        </div>
        <div class="col-lg-2">
          <a href="https://www.biozentrum.unibas.ch">
            <img src="/sib_images/BZ_logo_134x75.png" alt="BIOZENTRUM logo">
          </a>
        </div>    
      </div>
    </div>
      
    <div class="container-fluid" style="margin-top: 1em;">
      
      <div class="col-lg-2">
	<ul id="info_navbar" class="nav nav-pills nav-stacked">
	  <li id="about-pill" class="active"><a href="#about">About</a></li>
	  <li id="encode-pill" class="active"><a href="https://crunch.unibas.ch/ENCODE_REPORTS/">Encode Reports</a></li>
	  <!-- li id="dwt-pill" class="active"><a href="http://crunch.unibas.ch/DWT/table.html">Dinucleotide Weight Tensor Reports</a></li -->
	</ul>
      </div>
      
      <div class="col-lg-8">
	<!-- Under construction imahe>
	<div class="row">
	  <div class="col-lg-2 col-lg-offset-4">
	    <img height="300px" src="/under_construction.jpg">
	  </div>
	</div>
	< -->
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4> <b>Usage:</b> Select the genome from which your data derive, select either the raw data files to upload, links to the data, or SRR IDs of datasets, and then click the "Start upload"  button.</h4>
          </div>
          <div class="panel-body">
            <div class="form-group row">
              <label for="email" class="col-lg-2 col-form-label">Email:</label>
              <div class="col-lg-6">
                <input type="text" class="form-control col-lg-6" id="email" data-toggle="tooltip"
                        autocomplete="email"
                       title="Please enter your email address. You will get a message with a link to your results as soon as the analysis is finished.">
              </div>
	      <div class="col-lg-2">
		<i>Optional</i>
	      </div>
            </div>
            <div class="form-group row">
              <label class="col-lg-2 col-form-label">Project name:</label>
              <div class="col-lg-6">
                <input type="text" class="form-control" data-toggle="tooltip"
                       title="Give an unique name to your project." id="project" >
              </div>
	      <div class="col-lg-2">
		<i>Optional</i>
	      </div>
            </div>
            <div class="form-group row">
              <label class="col-lg-2 col-form-label">Genome version:</label>  
              <div class="btn-group col-lg-10" data-toggle="buttons" id="organism_row">
                <label class="btn btn-info active">
                  <input type="radio" id="organism_hg19" name="organism" value="hg19">
                  Human (hg19) 
                </label>
                <label class="btn btn-info">
                  <input type="radio" id="organism_mm9" name="organism" value="mm9">
                  Mouse (mm9)
                </label>
                <label class="btn btn-info">
                  <input type="radio" id="organism_mm10" name="organism" value="mm10">
                  Mouse (mm10)
                </label>    
                <label class="btn btn-info">
                  <input type="radio" id="organism_dm3" name="organism" value="dm3">
                  Drosophila (dm3)
                </label>
              </div>
            </div>
            <div class="form-group row">
              <div class="col-lg-2">
                <button class="btn btn-primary"  type="button" data-toggle="collapse" data-target="#collapseAdvanced" aria-expanded="false" aria-controls="collapseAdvanced">
                  Advanced options
                </button>
              </div>
            </div>
            <div class="collapse" id="collapseAdvanced">
              <div class="form-group row">
                <label class="col-lg-3 col-form-label">Foreground window size:</label>
                <div class="col-lg-2">
                  <input type="text" class="form-control" data-toggle="tooltip"
                         id="fg_window" name="fg_window" value="500">
                </div>
                <label class="col-lg-3 col-form-label">Background window size:</label>
                <div class="col-lg-2">
                  <input type="text" class="form-control" data-toggle="tooltip"
                         id="bg_window" name="bg_window" value="2000">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-lg-3 col-form-label">Window step size:</label>
                <div class="col-lg-2">
                  <input type="text" class="form-control" data-toggle="tooltip"
                         id="step" name="step" value="250">
                </div>
                <label class="col-lg-3 col-form-label">False discovery rate:</label>
                <div class="col-lg-2">
                  <input type="text" class="form-control" data-toggle="tooltip"
                         id="fdr" name="fdr" value="0.1">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-lg-3 col-form-label">Adaptor sequence:</label>
                <div class="col-lg-7">
                  <input type="text" class="form-control" data-toggle="tooltip"
                         id="adaptor" name="adaptor" value="" title="Example: CAAGCAGAAGACGGCATACGAGATCGTGATGTGACTGGAGTTC">
                </div>
              </div>
              <input id="flag" name="flag" type="hidden" value="0">
            </div>
	    
	    <div class="form-group row">
	      <div class="col-lg-10">
            <ul class="nav nav-tabs" role="tablist">
              <li class="active" role="presentation"><a aria-controls="file_upload" role="tab" data-toggle="tab" href="#file_upload">Upload files</a></li>
              <li role="presentation"><a aria-controls="url_upload" role="tab" data-toggle="tab" href="#url_upload">Upload file links</a></li>
	      <li role="presentation"><a aria-controls="srr_upload" role="tab" data-toggle="tab" href="#srr_upload">Upload SRR IDs</a></li>
            </ul>
	    </div>
	    </div>
            <div class="tab-content">
              <div id="file_upload" role="tabpanel" class="tab-pane fade in active">
                <!-- The file upload form used as target for the file upload widget -->
                <form id="fileupload" action="/crunch/upload" method="POST" enctype="multipart/form-data">
                  <input type="hidden" name="sd" value="" id="sd">
                  <div class="form-group row fileupload-buttonbar">
		    <div class="col-lg-10">
                    <!-- The fileinput-button span is used to style the file input field as button -->
                    <span class="btn btn-success fileinput-button">
                      <i class="glyphicon glyphicon-plus"></i>
                      <span>Foreground files</span>
                      <input type="file" id="fg_files" name="fg_files[]" multiple>
                    </span>
                    <span class="btn btn-info fileinput-button">
                      <i class="glyphicon glyphicon-plus"></i>
                      <span>Background files</span>
                      <input type="file" id="bg_files" name="bg_files[]" multiple>
                    </span>
                    <button type="submit" class="btn btn-primary start">
                      <span>Start upload</span>
                    </button>
                    <button type="reset" class="btn btn-warning cancel">
                      <span>Cancel upload</span>
                    </button>
                    <!-- The loading indicator is shown during file processing -->
                    <span class="fileupload-loading"></span>
		    </div>
                  </div>
                  <!-- The global progress information -->
                  <div class="col-lg-12 fileupload-progress fade">
                    <!-- The global progress bar -->
                    <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                      <div class="progress-bar progress-bar-success" style="width:0%;"></div>
                    </div>
                    <!-- The extended global progress information -->
                    <div class="progress-extended">&nbsp;</div>
                  </div>
		  <!-- The table listing the files available for upload/download -->
		  <table role="presentation" class="table table-striped"><tbody class="files"></tbody></table>
		</form>
              </div>
	      <!-- URLs upload -->
              <div id="url_upload" role="tabpanel" class="tab-pane fade">
		<div class="form-group row">
                  <label class="col-lg-10 col-form-label">Please enter links to foreground files:</label>
		</div>
		<div class="form-group row">
                  <div class="col-lg-10">
                    <textarea class="form-control" data-toggle="tooltip"
                              rows="5" id="fg_links"
                              id="url_list" name="url_list" 
			      title="Example:" placeholder="http://aaa.bb/xxx.gz"></textarea>
                  </div>
		</div>
		<div class="form-group row">
                  <label class="col-lg-10 col-form-label">Please enter links to background files:</label>
		</div>
		<div class="form-group row">
                  <div class="col-lg-10">
                    <textarea class="form-control" data-toggle="tooltip"
                              rows="5" id="bg_links"
                              id="url_list" name="url_list" 
			      title="Example:" placeholder="http://aaa.bb/yyy.gz"></textarea>
                  </div>
		</div>
		<div class="form-group row">
                  <div class="col-lg-10">
		    <button type="button" class="btn btn-primary" id="submit_links">Submit links</button>
                  </div>
		</div>		
              </div>
	      <!-- SRR upload -->
              <div id="srr_upload" role="tabpanel" class="tab-pane fade">
		<div class="form-group row">
                  <label class="col-lg-10 col-form-label">Please enter SRR IDs for foreground files (one per line):</label>
		</div>
		<div class="form-group row">
                  <div class="col-lg-10">
                    <textarea class="form-control" data-toggle="tooltip"
                              rows="5" id="fg_srr"
                              id="srr_list" name="srr_list" 
			      title="Example:" placeholder="SRR123456"></textarea>
                  </div>
		</div>
		<div class="form-group row">
                  <label class="col-lg-10 col-form-label">Please enter SRR IDs for background files (one per line):</label>
		</div>
		<div class="form-group row">
                  <div class="col-lg-10">
                    <textarea class="form-control" data-toggle="tooltip"
                              rows="5" id="bg_srr"
                              id="srr_list" name="srr_list" 
			      title="Example:" placeholder="SRR765432"></textarea>
                  </div>
		</div>
		<div class="form-group row">
                  <div class="col-lg-10">
		    <button type="button" class="btn btn-primary" id="submit_srr">Submit SRR IDs</button>
                  </div>
		</div>		
              </div>
            </div>
	  </div>
	</div>
	<!-- Info navbar -->
	<div class="panel panel-default" id="about">
	  <div class="panel-heading">
	    <h3>About</h3>
	  </div>
	  <div class="panel-body">
	    <div class="lg-col-12">
	      <p>
		<span style="font-weight:bold;">CRUNCH</span> - A completely automated pipe-line for ChIP-seq data
		analysis, starting from raw sequencing reads, through quality
		filtering, read mapping, fragment size estimation, peak calling, peak
		annotation and comprehensive regulatory motif analysis. It runs with
		data from human (hg19), mouse (mm9) or drosophila (dm3).
	      </p>
	      <p>
		<a href="https://genome.cshlp.org/content/early/2019/05/24/gr.239319.118.abstract">
		  <b>Crunch: Integrated processing and modeling of ChIP-seq data in terms of regulatory motifs</b><br>
		  Severin M Berger, Mikhail Pachkov, Phil Arnold, Saeed Omidi, Nicholas Kelley, Silvia Salatino and Erik van Nimwegen<br>
		  Genome Research, 2019
		</a>

	      </p>
	      <p>
		To analyse your data with CRUNCH, you only need to upload raw
		sequencing reads. The preferred format is FASTQ, but also FASTA format
		and a <a href="#bed_weight_format">weighted BED format</a> are allowed. Select the files you want to
		upload by clicking the 'Foreground files' and 'Background files'
		buttons for foreground (a.k.a. immunprecipitation, IP) and background
		(a.k.a. input, control or whole cell extract) files, respectively. You
		may select multiple files for both fore- and background and you may
		select uncompressed files, but we encourage users to upload
		gzip-compressed files (e.g. .fastq.gz). For human data you may omit
		the background files and only upload foreground files, although we
		advise to include the corresponding background files if available -
		for mouse and drosophila it is even mandatory.
	      </p>
	      <p>
		Additionally, you may specify your email address so that we can notify
		you when your analysis is ready as well as a project name.
	      </p>
	      
	      <p>
		Although usually not necessary, the user may adjust advanced options:
	      </p>
	      <ul>
		<li>False discovery rate (FDR) - a number between 0 and 1 that
		  controls the number of reported peaks. The greater the FDR the
		  more peaks will be reported. Default value is 0.1 which means that
		  10% of the reported peaks are assumed to be false positives.
		  
		<li>Foreground and background window sizes, and window step size -
		  The window sizes used to scan the genome to find significant
		  ChIP-seq signal enrichment.
		  
		<li>Adapter sequence - Sequencing machines use a small adapter
		  sequence that is ligated to the DNA fragments of interest. CRUNCH
		  by default checks each sequencing read for remainders of this
		  adapter and uses for this a small library of commonly used adapter
		  sequences. If you are aware of the adapter sequence used in your
		  data, you may specify it here.
	      </ul>
	      
	      <p>
		Click 'Start upload' to upload your data and start the analysis. Now
		you are done.
	      </p>
	      <h3>Contact us:</h3>
	      <p id="contact">
	      </p>
	      <hr>
	      <p id="bed_weight_format">
		Weighted BED format is 6-column BED format, where the 5th column of each line contains
		a weight which represents the number of reads that mapped to that
		position divided by the total number of positions this read was
		reported to map to.
	      </p>
	    </div>
	  </div>
	</div>
      </div>
    </div>

    <!-- The template to display files available for upload -->
    <script id="template-upload" type="text/x-tmpl">
      {% for (var i=0, file; file=o.files[i]; i++) { %}
      <tr class="template-upload fade {% if (fg_files.indexOf(file.name) > -1) { %} success {% } else if (bg_files.indexOf(file.name) > -1) { %} info {% } %}">
	<td>
	  <p class="name">{%=file.name%}</p>
	  {% if (file.error) { %}
	  <div><span class="label label-important">Error</span> {%=file.error%}</div>
	  {% } %}
	</td>
	<td>
	  <p class="size">{%=o.formatFileSize(file.size)%}</p>
	  {% if (!o.files.error) { %}
	  <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"><div class="progress-bar progress-bar-success" style="width:0%;"></div></div>
	  {% } %}
	</td>
	<td>
	  {% if (!o.files.error && !i && !o.options.autoUpload) { %}
	  <button class="btn btn-primary start" style="display: none;">
	    <i class="icon-upload icon-white"></i>
	    <span>Start</span>
	  </button>
	  {% } %}
	  {% if (!i) { %}
	  <button class="btn btn-warning cancel">
	    <i class="icon-ban-circle icon-white"></i>
	    <span>Cancel</span>
	  </button>
	  {% } %}
	</td>
      </tr>
      {% } %}
    </script>
    <!-- The template to display files available for download -->
    <script id="template-download" type="text/x-tmpl">
      {% for (var i=0, file; file=o.files[i]; i++) { %}
      <tr class="template-download fade">
	<td>
	  <span class="preview">
	    {% if (file.thumbnail_url) { %}
	    <a href="{%=file.url%}" title="{%=file.name%}" data-gallery="gallery" download="{%=file.name%}"><img src="{%=file.thumbnail_url%}"></a>
	    {% } %}
	  </span>
	</td>
	<td>
	  <p class="name">
	    <a href="{%=file.url%}" title="{%=file.name%}" data-gallery="{%=file.thumbnail_url&&'gallery'%}" download="{%=file.name%}">{%=file.name%}</a>
	  </p>
	  {% if (file.error) { %}
	  <div><span class="label label-important">Error</span> {%=file.error%}</div>
	  {% } %}
	</td>
	<td>
	  <span class="size">{%=o.formatFileSize(file.size)%}</span>
	</td>
	<td>
	  <!-- button class="btn btn-danger delete" data-type="{%=file.delete_type%}" data-url="{%=file.delete_url%}"{% if (file.delete_with_credentials) { %} data-xhr-fields='{"withCredentials":true}'{% } %} -->
	    <!-- i class="icon-trash icon-white"></i -->
	    <!-- span>Delete</span -->
	  <!-- /button -->
	  <!-- input type="checkbox" name="delete" value="1" class="toggle" -->
	</td>
      </tr>
      {% } %}
    </script>

    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery-ui/jquery-ui.min.js"></script>
    <script src="/js/bootstrap/js/bootstrap.min.js"></script>
    <!-- The Templates plugin is included to render the upload/download listings -->
    <script src="/js/JavaScript-Templates/js/tmpl.min.js"></script>
    <!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
    <script src="/js/jQuery-File-Upload/js/jquery.iframe-transport.js"></script>
    <!-- The basic File Upload plugin -->
    <script src="/js/jQuery-File-Upload/js/jquery.fileupload.js"></script>
    <!-- The File Upload processing plugin -->
    <script src="/js/jQuery-File-Upload/js/jquery.fileupload-process.js"></script>
    <!-- The File Upload validation plugin -->
    <script src="/js/jQuery-File-Upload/js/jquery.fileupload-validate.js"></script>
    <!-- The File Upload user interface plugin -->
    <script src="/js/jQuery-File-Upload/js/jquery.fileupload-ui.js"></script>
    <!-- The main application script -->
    <script src="/js/crunch.js"></script>
    <!-- The XDomainRequest Transport is included for cross-domain file deletion for IE8+ -->
    <!--[if gte IE 8]><script src="js/cors/jquery.xdr-transport.js"></script><![endif]-->
    <div id="sib_footer">
      <div id="sib_footer_content">
	<a href="http://www.isb-sib.ch">Swiss Institute of Bioinformatics</a>
	<div id="sib_footer_right"> 
	  <a href="#TOP" id="sib_footer_gototop">
	    <span style="padding-left: 10px">Back to the Top</span>
	  </a>
	</div>
      </div>
    </div>
  </body>
</html>