<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Molecular Evolution and Phylogenetics</title>
</head>

<body>

<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="680" id="AutoNumber6">
    <tr>
      <td width="100%">
      <p align="center"><map name="FPMap0">
      <area href="http://www.psu.edu" shape="rect" coords="3, 5, 110, 69">
      </map><img border="0" src="neilogonew.jpg" usemap="#FPMap0" width="657" height="70"></td>
    </tr>
  </table>
  </center>
</div>
<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="720" id="AutoNumber7" height="46">
    <tr>
      <td width="720" align="center" height="46">
      <p align="center"><font face="Arial" size="2">&nbsp;<a href="http://www.bio.psu.edu/People/Faculty/Nei/Lab/">Home</a> 
    | <a href="http://www.bio.psu.edu/people/faculty/nei/lab/cv.htm">CV</a> | <font color="#009900">
      <a href="http://mep.bio.psu.edu/databases/">Databases</a></font> 
    | <a href="http://imeg.psu.edu/imegseminars.htm">IMEG 
      Seminars</a>&nbsp;|
      <a href="http://www.bio.psu.edu/people/faculty/nei/lab/journals.htm">Journals</a><br>
      </font><font face="Arial" style="font-size: 3pt">&nbsp;</font><font face="Arial" size="2"><br>
      <a href="http://mep.bio.psu.edu/">MEP-online</a> |
      <a href="http://www.bio.psu.edu/people/faculty/nei/lab/people.htm">People</a> |
      <a href="http://www.bio.psu.edu/people/faculty/nei/lab/publications.htm">Publications</a> |
      <a href="http://www.bio.psu.edu/people/faculty/nei/lab/software.htm">Software</a> |&nbsp;<font color="#009900"><a href="http://www.bio.psu.edu/people/faculty/nei/lab/text.htm">Text only version</a></font></font></td>
    </tr>
  </table>
  </center>
</div>
<div align="center">
<center>
<table width="690" border="0" height="1" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
  <tr>
    <td width="100%" bgColor="#FFFFFF" height="1"><hr color="#526B85" SIZE="1"></td>
  </tr>
</table>
</center>
</div>
<div align="center">
<center>
<table width="690" border="0" height="41" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
  <tr>
    <td width="686" bgColor="#FFFFFF" height="41">
    <p align="center"><b><font face="Arial" style="font-size: 5pt"><br>
    </font><font face="Arial" size="5">Software - Readme File</font></b><font face="Arial" size="2"><br>
    </font><span style="font-size: 5pt">&nbsp; </span>
    </td>
  </tr>
</table>
</center>
</div>
<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="680" id="AutoNumber73" height="1">
    <tr>
      <td width="100%" height="1">
      <span style="font-size: 5pt">&nbsp;</span></td>
    </tr>
  </table>
  </center>
</div>
<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="680" id="AutoNumber72" height="1">
    <tr>
      <td width="700" height="42" bgcolor="#899FB6">
      <font color="#FFFFFF"><b><font size="+2">ANCESTOR:&nbsp;</font></b><br>
            <font size="+2">Inference of Ancestral Amino Acid Sequences by 
            the Distance-Based Bayesian Method</font></font></td>
    </tr>
    <tr>
      <td width="700" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    </table>
  </center>
</div>
<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="680" id="AutoNumber67" height="1">
    <tr>
      <td width="700" height="17" colspan="2">(c) Copyright April ,1997 by Jianzhi Zhang and the Pennsylvania 
            State University. Permission is granted to copy this document 
            provided that no fee is charged for it and that this copyright 
            notice is not removed. ANCESTOR is distributed free of charge by:<br>
&nbsp;</td>
    </tr>
    <tr>
      <td width="67" height="8"></td>
      <td width="633" height="8">
      <p style="margin-top: 0; margin-bottom: 0">Jianzhi Zhang<br>
                  Institute of Molecular Evolutionary Genetics<br>
                  Department of Biology<br>
                  322 Mueller Laboratory<br>
                  The Pennsylvania State University<br>
                  University Park, PA 16802 USA</p>
      <p style="margin-top: 0; margin-bottom: 0">&nbsp;</p>
      <p style="margin-top: 0; margin-bottom: 0">Current Address:</p>
      <p style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">Associate Professor of 
      Ecology</p>
      <p style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">and Evolutionary Biology</p>
      <p style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">University of Michigan</p>
      <p style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">Ann Arbor, MI<br>
      E-mail: <a href="mailto:jianzhi@umich.edu">jianzhi@umich.edu</a></p>
      <p style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">
      <a href="http://www.eeb.lsa.umich.edu/eeb/people/jianzhi/index.html">
      Jianzhi Zhang Homepage</a></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="19"><b><font size="4">Suggested 
      citation<br>
      &nbsp;&nbsp;&nbsp;&nbsp;
      </font></b>
            <a href="http://mep.bio.psu.edu/../../../@MEP-J~1/!ready/SERVER~1/downloads/44n7ps139.pdf">
            Zhang J, Nei M (1997)</a> Accuracies of ancestral amino acid 
            sequences inferred by the parsimony, likelihood, and distance 
            methods. J Mol Evol 44(Suppl 1):S139-S146</td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span><b><font size="+1">Introduction</font></b> <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            ANCESTOR is designed to infer ancestral amino acid sequences from a 
            set of homologous amino acid sequences whose phylogenetic 
            relationships are known. This package contains one program: 
            ancestor.exe, which is written in C language. The program can be 
            used on IBM PC compatible computers (under Windows).</td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="19"><b><font size="+1">Installation</font></b> <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            First you have to unzip the file ancestor.zip by using the program 
            pkunzip.exe. After that, you will see the following files:<br>
            <br>
            ancestor.c (source code) <br>
            ancestor.exe (executable file) <br>
            jtt.pro (JTT substitution matrix) <br>
            lysozyme.aa (an example data file, see Stewart et al. 1987) <br>
            manual (this file) <br>
            result (output file from running ancestor lysozyme.aa)
            <p>&nbsp;&nbsp;&nbsp;&nbsp; To install ANCESTOR on your computer's hard disk drive (&quot;C&quot; drive 
            given here, for example), you should create a directory where the 
            files of this package will be present. To do this, type the 
            following c:\md ancestor (Enter) <br>
&nbsp;&nbsp;&nbsp;&nbsp; <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            To copy the ANCESTOR files onto your hard disk drive, insert the 
            floppy disk containing the programs into your floppy drive (&quot;A&quot; 
            drive given here, for example). Then, enter the following command 
            c:\copy a:*.* c:\ancestor\*.* (Enter)</td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="19"><b><font size="+1">Input file</font></b> <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            To use the program, you need an input file containing the amino acid 
            sequences and the tree topology of these sequences (see
            <a href="http://">lysozyme.aa</a> for an example). This file begins 
            with two numbers: the number of sequences and the number of amino 
            acid sites (sequence length). The second line will be the name of 
            the first sequence, and the third line will be the first sequence, 
            and so on. Only the one letter code (capitalized) for the 20 amino 
            acids are allowed in the sequences. The sequences should be aligned 
            and gaps or any other symbols be removed already. The last line of 
            the file is the tree topology of the sequences. The tree format is 
            the same as that used in PHYLIP package (Felsenstein 1995). Note 
            that the tree is unrooted, so trification rather than bification is 
            required for the deepest branching node. For example, the topology 
            of the following tree can be expressed by <br>
      <b><tt><br>
      (((1,3),2),6,((4,7),(5,8)))</tt></b>
            <center>
            <table cols="1" width="50%">
              <tr>
                <td><tt>11 |----------- 1</tt> <br>
                <tt>10 |-----------|</tt> <br>
                <tt>|----------| |---------------- 3</tt> <br>
                <tt>| |------------------------ 2</tt> <br>
                <tt>| |----------------------------- 6</tt> <br>
                <tt>|---------------| |---------- 4</tt> <br>
                <tt>9 | |--------|</tt> <br>
                <tt>| | 13 |</tt> <br>
                <tt>| | |------ 7</tt> <br>
                <tt>|-----|</tt> <br>
                <tt>12 | |---- 5</tt> <br>
                <tt>|------|</tt> <br>
                <tt>14 |----- 8</tt></td>
              </tr>
            </table>
            </center>
            <p>&nbsp;&nbsp;&nbsp;&nbsp; Note that in the topology expression, the numbers refer to the 
            order of the present-day sequences given in the input file. Also 
            note that in the topology expression, there are only numbers and &quot;, 
            &quot; without any space. <br>
            The tree of the lysozyme sequences in the example data file is<b><tt>(((1,2),3),4,(5,6))</tt></b>(Stewart 
            et al. 1987).<br>
&nbsp;</p>
            <center>
            <table cols="1" width="50%" border="0">
              <tr>
                <td><tt>9 |------------------1 langur</tt> <br>
                <tt>8 |-----|</tt> <br>
                <tt>|---| |------------------2 baboon</tt> <br>
                <tt>7 | |</tt> <br>
                <tt>|---| |-------------------3 human</tt> <br>
                <tt>| |</tt> <br>
                <tt>| |--------------------4 rat</tt> <br>
                <tt>| |------------5 cow</tt> <br>
                <tt>|----------------|</tt> <br>
                <tt>10 |---------------------------6 horse</tt></td>
              </tr>
            </table>
            </center>
            <p>&nbsp;&nbsp;&nbsp;&nbsp; You should also know the system of the notation of ancestral 
            nodes because in the output file, the ancestral sequences are 
            presented according to these node notations. The deepest node (the 
            trification node specified in your expression of the tree topology) 
            is denoted by N+1, where N is the number of sequences in the tree. 
            In the above lysozyme example with N=6, the deepest node links the 
            groups ((1,2),3), 4, and (5,6). So, &quot;7&quot; is given to the deepest node 
            as shown in the tree. The notation of the nodes can be figured out 
            from the output file, where I describe the branches that connect the 
            nodes. Note that the ancestral (interior) nodes are numbered from 
            N+1 to 2N-2.</td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="19"><b><font size="+1">Computation</font></b> <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            To infer the ancestral sequences from the data file, type 
            c:\ancestor\ancestor filename. For example, to try the lysozyme.aa 
            data, type c:\ancestor\ancestor lysozyme.aa <br>
            The computation is the same as described in Zhang and Nei (1997), 
            except that the branch lengths are estimated by the ordinary 
            least-squares method provided by Rzhetsky and Nei (1993), rather 
            than the FITCH algorithm in the PHYLIP package (Felsenstein 1995). 
            Because of sampling errors, the length of a branch may be estimated 
            to be negative. In this case, the branch length is assigned to be 
            zero. Computer simulation has shown that use of this approach does 
            not affect the inference of the ancestral sequences. The JTT-f model 
            of amino acid substitution (see Zhang and Nei 1997) is used in the 
            program.</td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="19"><b><font size="+1">Output file</font></b> <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            The output of the ancestor.exe is given in the file named &quot;result&quot;. 
            The ancestral sequences are presented in three different formats.
            <br>
            (1) <b>Site by site and pathway by pathway.</b> From this format, 
            one can see the probability of a pathway (amino acids at all 
            ancestral nodes) at a given site. <br>
            (2) <b>Site by site and node by node.</b> From this format, one can 
            see the most likely amino acid and its probability for a given node 
            at a given site. <br>
            (3) <b>The entire sequence for each node.</b> The average 
            probability of the entire sequence is also given.</td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="19"><b><font size="+1">Limitations of the program</font></b> <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            The program is designed for inferring ancestral amino acid 
            sequences. A program specifically for inferring ancestral protein 
            coding nucleotide sequences is under development.</td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="1"><span style="font-size: 8pt">&nbsp;</span></td>
    </tr>
    <tr>
      <td width="700" colspan="2" height="19"><b><font size="+1">References</font></b> <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            Felsenstein, J. (1995). PHYLIP: phylogeny inference package. Version 
            3.57c. University of Washington, Seattle. <br>
      <br>
&nbsp;&nbsp;&nbsp;&nbsp;
            Rzhetsky, A., and M. Nei (1993). Theoretical foundation of the 
            minimum-evolution model of phylogenetic inference. Mol. Biol. Evol. 
            10:1073-1095. <br>
      <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            Stewart, C.-B., J. W. Schilling, and A. C. Wilson. (1987) Adaptive 
            evolution in the lysozymes of foregut fermenters. Nature 
            330:401-404. <br>
      <br>
            &nbsp;&nbsp;&nbsp;&nbsp;
            Zhang, J., and M. Nei (1997). Accuracies of ancestral amino acid 
            sequences inferred by the parsimony, likelihood, and distance 
            methods. J. Mol. Evol. 44:S139-S146.</td>
    </tr>
  </table>
  </center>
</div>
<div align="center">
<center>
<table width="690" border="0" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0" height="142">
  <tr>
    <td vAlign="bottom" width="100%" height="15">
    <hr color="#526B85" SIZE="1"></td>
  </tr>
  <tr>
    <td width="100%" height="43">
      <p align="center"><font face="Arial" size="2">&nbsp;<a href="http://www.bio.psu.edu/People/Faculty/Nei/Lab/">Home</a> 
    | <a href="http://www.bio.psu.edu/people/faculty/nei/lab/cv.htm">CV</a> | <font color="#009900">
      <a href="http://mep.bio.psu.edu/databases/">Databases</a></font> 
    | <a href="http://imeg.psu.edu/imegseminars.htm">IMEG 
      Seminars</a>&nbsp;|
      <a href="http://www.bio.psu.edu/people/faculty/nei/lab/journals.htm">Journals</a><br>
      </font><font face="Arial" style="font-size: 3pt">&nbsp;</font><font face="Arial" size="2"><br>
      <a href="http://mep.bio.psu.edu/">MEP-online</a> |
      <a href="http://www.bio.psu.edu/people/faculty/nei/lab/people.htm">People</a> |
      <a href="http://www.bio.psu.edu/people/faculty/nei/publications.htm">Publications</a> |
      <a href="http://www.bio.psu.edu/people/faculty/nei/lab/software.htm">Software</a> |&nbsp;<font color="#009900"><a href="http://www.bio.psu.edu/people/faculty/nei/lab/text.htm">Text only version</a></font></font></td>
  </tr>
  <tr>
    <td vAlign="bottom" width="100%" height="15">
    <hr color="#526B85" SIZE="1"></td>
  </tr>
  <tr>
    <td vAlign="bottom" width="100%" height="69" bgcolor="#F3F0ED">
    <p align="center"><font face="Arial" size="2">| <a href="http://www.bio.psu.edu/">Department of Biology</a>&nbsp; |&nbsp;
    <a href="http://www.science.psu.edu/">Eberly College of Science</a>&nbsp;|<br>
    </font><font face="Arial" style="font-size: 3pt">&nbsp;</font><font face="Arial" size="2"><br>
    | <a href="http://www.bio.psu.edu/People/Faculty/Nei/Lab/imeg.htm">Institute of Molecular 
    Evolutionary Genetics</a>&nbsp;| <a href="http://www.psu.edu//">Penn State</a>&nbsp;|<br>
    ©2002 The Pennsylvania State University<br>
    This page was last updated  6/11/09 by <a href="mailto:msr26@psu.edu">M. 
    Ricardo</a>. </font></td>
  </tr>
</table>

</center>

</div>

<p align="center">&nbsp;</p>

<p>&nbsp;</p>

</body>

</html>